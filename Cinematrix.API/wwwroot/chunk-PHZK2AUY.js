import{a as Ve}from"./chunk-ZJRYDETP.js";import{a as ue,b as m,c as K,d as Q,e as W,f as X,g as Z,h as ee,i as te,j as ie,k as ne,l as oe}from"./chunk-U2FPY7MB.js";import{$ as P,Aa as Ne,D as h,E as he,G as l,Ga as fe,Ha as De,Ia as D,J as N,Ja as Be,Ka as Me,N as p,Na as I,P as g,S as u,U as T,V as y,W as F,X as n,Y as o,Z as c,_ as ce,a as Re,aa as d,b as Ie,ca as r,da as C,ea as _,f as q,fa as Ce,g as M,ga as z,i as se,ia as E,ja as w,ka as de,l as V,n as $,q as ke,qa as Y,t as x,ua as G,v as O,va as J,w as j,x as U,y as H}from"./chunk-7GXU7I4D.js";var $e=()=>({exact:!0}),Ee=class i{authService=x(Ve);router=x(D);logout(){this.authService.logout(),this.router.navigateByUrl("/auth")}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=N({type:i,selectors:[["app-admin-layout"]],decls:22,vars:8,consts:[[1,"w-full","min-h-screen","bg-[#1E1B2E]"],[1,"drawer"],["id","my-drawer","type","checkbox",1,"drawer-toggle"],[1,"drawer-content"],[1,"flex","items-end","justify-between","max-w-[1600px]","w-[90%]","mx-auto","mt-10"],["for","my-drawer",1,"btn","bg-primary-content","drawer-button"],[1,"btn","btn-primary",3,"click"],[1,"max-w-[1600px]","w-[90%]","mx-auto"],[1,"drawer-side"],["for","my-drawer","aria-label","close sidebar",1,"drawer-overlay"],[1,"menu","bg-primary-content","text-base-content","min-h-full","w-80","p-4"],[1,"text-xl"],[1,"inline-flex","items-center","gap-2",3,"routerLink","routerLinkActive","routerLinkActiveOptions"],[1,"fa-solid","fa-film","text-[1.2em]","relative","top-[1px]"],[1,"fa-solid","fa-ticket","text-[1.2em]","relative","top-[1px]"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1),c(2,"input",2),n(3,"div",3)(4,"div",4)(5,"label",5),r(6,"Panel"),o(),n(7,"button",6),P("click",function(){return a.logout()}),r(8,"Salir"),o()(),n(9,"div",7),c(10,"router-outlet"),o()(),n(11,"div",8),c(12,"label",9),n(13,"ul",10)(14,"li",11)(15,"a",12),r(16,"Pel\xEDculas"),c(17,"i",13),o()(),n(18,"li",11)(19,"a",12),r(20,"Sesiones "),c(21,"i",14),o()()()()()()),t&2&&(l(15),g("routerLink","/admin/peliculas")("routerLinkActive","bg-[#1E1B2E] text-white")("routerLinkActiveOptions",z(6,$e)),l(4),g("routerLink","/admin/sesiones")("routerLinkActive","bg-[#1E1B2E] text-white")("routerLinkActiveOptions",z(7,$e)))},dependencies:[De,Be,Me],styles:["[_nghost-%COMP%]{display:block}"]})};var _e=class{static mapRESTFilmToFilm=e=>({id:e.id,titulo:e.titulo,categoria:e.categoria,anio:e.anio,calificacion:e.calificacion,duracion:e.duracion,formato:e.formato,imagen:e.imagen,poster:e.poster,sinopsis:e.sinopsis,trailer:e.trailer,sesiones:e.sesiones});static mapRESTInfoPeliculaToInfoPelicula=e=>({categorias:e.categorias,calificaciones:e.calificaciones,formatos:e.formatos,pelicula:e.pelicula?this.mapRESTFilmToFilm(e.pelicula):null})};var ge=class{static mapRESTSesionesToSesiones=e=>({pelicula:e.pelicula,sala:e.sala,estado:e.estado,inicio:e.inicio,fin:e.fin,id:e.id});static mapRESTSesionesArrayToSesionesArray=e=>e.map(this.mapRESTSesionesToSesiones);static mapRestToSesionInfo(e){return{peliculas:e.peliculas,salas:e.salas,sesion:e.sesion?Ie(Re({},e.sesion),{inicio:e.sesion.inicio,fin:e.sesion.fin}):void 0}}};var L="/api/admin/",B=class i{http=x(Ne);getPeliculas(){return this.http.get(`${L}peliculas`).pipe(se(e=>e.map(_e.mapRESTFilmToFilm)),$(e=>console.log(e)),V(e=>M(()=>new Error("No se pudo obtener la cartelera"))))}getPeliculaInfo(e){return this.http.get(`${L}peliculas/${e}`).pipe(se(t=>_e.mapRESTInfoPeliculaToInfoPelicula(t)),$(t=>console.log(t)),V(t=>M(()=>new Error("No se pudo obtener la cartelera"))))}actualizarPelicula(e,t){return console.log({id:e,pelicula:t}),this.http.put(`${L}peliculas/${e}`,t).pipe($(a=>console.log(a)),V(a=>M(()=>new Error("No se pudo obtener la cartelera"))))}eliminarPelicula(e){return console.log({id:e}),this.http.delete(`${L}peliculas/${e}`).pipe($(t=>console.log(t)),V(t=>M(()=>new Error("No se pudo obtener la cartelera"))))}getPeliculaParametersInfo(){return this.http.get(`${L}peliculas/info`).pipe(se(e=>_e.mapRESTInfoPeliculaToInfoPelicula(e)),$(e=>console.log(e)),V(e=>M(()=>new Error("No se pudo obtener la cartelera"))))}postPelicula(e){return this.http.post(`${L}peliculas`,e).pipe($(t=>console.log(t)),V(t=>M(()=>new Error("No se pudo obtener la cartelera"))))}getSesiones(e,t){console.log(e,t);let a=e??"",s=t??"";return this.http.get(`${L}sesiones?fecha=${a}&&estado=${s}`).pipe(se(ge.mapRESTSesionesArrayToSesionesArray),$(f=>console.log(f)),V(f=>M(()=>new Error("No se pudo obtener la cartelera"))))}getSesion(e){return this.http.get(`${L}sesiones/${e}`).pipe(se(t=>ge.mapRestToSesionInfo(t)),$(t=>console.log(t)),V(t=>M(()=>new Error("No se pudo obtener la cartelera"))))}putSesion(e,t){return console.log(e,t),this.http.put(`${L}sesiones/${t}`,e).pipe($(a=>console.log(a)),V(a=>M(()=>new Error("No se pudo obtener la cartelera"))))}getInfoPostSesion(){return this.http.get(`${L}sesiones/info`).pipe($(e=>console.log(e)),se(e=>ge.mapRestToSesionInfo(e)),V(e=>M(()=>new Error("No se pudo obtener la cartelera"))))}getSiguienteFechaDisponibleSesion(e,t){return this.http.get(`${L}sesiones/fecha/siguiente?fecha=${e}&&sala=${t}`).pipe($(a=>console.log(a)),se(a=>new Date(a)),V(a=>M(()=>new Error("No se pudo obtener la cartelera"))))}crearSesion(e){return console.log(e),this.http.post(`${L}sesiones/crear`,e).pipe($(t=>console.log(t)),V(t=>M(()=>new Error("No se pudo obtener la cartelera"))))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ke({token:i,factory:i.\u0275fac,providedIn:"root"})};function Le(i,e){if(i&1){let t=ce();n(0,"tr")(1,"th",6),P("click",function(){let s=O(t).$implicit,f=d();return j(f.goToEditFilm(s.id))}),n(2,"p",7),r(3),E(4,"titlecase"),o()(),n(5,"td"),r(6),o(),n(7,"td"),r(8),o(),n(9,"td"),r(10),E(11,"titlecase"),o(),n(12,"td"),r(13),o(),n(14,"td"),r(15),o(),n(16,"td",8),r(17),o(),n(18,"td")(19,"button",9),P("click",function(){let s=O(t).$implicit,f=d();return j(f.goToEditFilm(s.id))}),c(20,"i",10),o()()()}if(i&2){let t=e.$implicit;l(3),C(w(4,7,t.titulo)),l(3),C(t.anio),l(2),C(t.calificacion),l(2),C(w(11,9,t.categoria)),l(3),C(t.duracion),l(2),C(t.formato),l(2),_(" ",t.sinopsis," ")}}var be=class i{router=x(D);goToEditFilm(e){this.router.navigate(["admin/peliculas",e])}adminService=x(B);peliculasResource=I({request:()=>({}),loader:({request:e})=>this.adminService.getPeliculas()});goCreateFilm(){this.router.navigate(["admin/peliculas/crear"])}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=N({type:i,selectors:[["app-admin-peliculas"]],decls:28,vars:0,consts:[[1,"mt-10"],[1,"flex","w-full","justify-between","items-center","pb-5"],[1,"text-white","text-4xl","font-medium"],[1,"fa-solid","fa-circle-plus","cursor-pointer","text-[35px]","text-[#b197fc]","hover:",3,"click"],[1,"overflow-x-auto","rounded-box","border","border-base-content/5","bg-[#f5f5f7]","text-[#3b0a57]","max-h-[70vh]","overflow-y-auto"],[1,"table"],[3,"click"],[1,"cursor-pointer"],[1,"truncate","max-w-[200px]","whitespace-nowrap","overflow-hidden"],[1,"btn","btn-sm","btn-outline","btn-primary",3,"click"],[1,"fa-solid","fa-pen-to-square"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"Pel\xEDculas"),o(),n(4,"div")(5,"i",3),P("click",function(){return a.goCreateFilm()}),o()()(),n(6,"div",4)(7,"table",5)(8,"thead")(9,"tr")(10,"th"),r(11,"T\xEDtulo"),o(),n(12,"th"),r(13,"A\xF1o"),o(),n(14,"th"),r(15,"Calificaci\xF3n"),o(),n(16,"th"),r(17,"Categor\xEDa"),o(),n(18,"th"),r(19,"Duraci\xF3n"),o(),n(20,"th"),r(21,"Formato"),o(),n(22,"th"),r(23,"Sinopsis"),o(),c(24,"th"),o()(),n(25,"tbody"),y(26,Le,21,11,"tr",null,T),o()()()()),t&2&&(l(26),F(a.peliculasResource.value()))},dependencies:[G],styles:["[_nghost-%COMP%]{display:block}"]})};function Oe(i,e){if(i&1&&(n(0,"option",11),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t),l(),C(w(2,2,t))}}function je(i,e){if(i&1){let t=ce();n(0,"tr")(1,"th",17),P("click",function(){let s=O(t).$implicit,f=d();return j(f.goToEditSesion(s.id))}),n(2,"p",18),r(3),E(4,"titlecase"),o()(),n(5,"td"),r(6),E(7,"titlecase"),o(),n(8,"td"),r(9),E(10,"date"),o(),n(11,"td"),r(12),E(13,"date"),o(),n(14,"td"),r(15),E(16,"titlecase"),o(),n(17,"td")(18,"button",19),P("click",function(){let s=O(t).$implicit,f=d();return j(f.goToEditSesion(s.id))}),c(19,"i",20),o()()()}if(i&2){let t=e.$implicit;l(3),C(w(4,5,t.pelicula)),l(3),C(w(7,7,t.sala)),l(3),C(de(10,9,t.inicio,"medium")),l(3),C(de(13,12,t.fin,"medium")),l(3),C(w(16,15,t.estado))}}function Ue(i,e){i&1&&(n(0,"h2",16),r(1," No se han encontrado resultados :("),o())}var Pe=class i{datePipe=x(J);goCreateSesion(){this.router.navigate(["admin/sesiones/crear"])}router=x(D);fb=x(ne);form=this.fb.group({estado:[""],fecha:[""]});estadoSesiones=h(["ACTIVA","CANCELADA","TERMINADA","PROGRAMADA"]);fecha=h(void 0);estado=h(void 0);adminService=x(B);getSesionesResource=I({request:()=>({estado:this.estado(),fecha:this.fecha()}),loader:({request:e})=>this.adminService.getSesiones(e.fecha,e.estado)});onFilter(){if(this.form.valid){console.log(this.form.value.fecha);let e;if(this.form.value.fecha){let t=new Date(this.form.value.fecha);e=this.datePipe.transform(t,"yyyy-MM-ddTHH:mm")}this.estado.set(this.form.value.estado??void 0),this.fecha.set(e??void 0)}}goToEditSesion(e){this.router.navigate(["admin/sesiones",e])}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=N({type:i,selectors:[["app-admin-sesiones"]],features:[Ce([J])],decls:39,vars:2,consts:[[1,"mt-10"],[1,"flex","flex-col","md:flex-row","w-full","justify-between","items-center","pb-5"],[1,"text-white","text-4xl","font-medium"],[3,"ngSubmit","formGroup"],[1,"flex","flex-col-reverse","mt-5","items-center","gap-0","md:flex-row","md:gap-10","md:justify-end","md:items-end"],[1,"flex","flex-col-reverse","mt-2","md:mt-0","md:flex-row","gap-5","items-center","md:items-end"],[1,"w-full"],["type","submit",1,"btn","btn-primary","w-full"],[1,"flex","flex-col-reverse","md:flex-row","gap-2"],["formControlName","estado",1,"select","w-50"],["value","","selected",""],[3,"value"],["type","date","formControlName","fecha",1,"input","w-50"],[1,"fa-solid","fa-circle-plus","cursor-pointer","text-[35px]","text-[#b197fc]","hover:",3,"click"],[1,"overflow-x-auto","rounded-box","border","border-base-content/5","bg-[#f5f5f7]","text-[#3b0a57]","max-h-[70vh]","overflow-y-auto","mb-10","md:mb-0"],[1,"table"],[1,"text-xl","bold","text-white","mt-5","text-center"],[3,"click"],[1,"cursor-pointer"],[1,"btn","btn-sm","btn-outline","btn-primary",3,"click"],[1,"fa-solid","fa-pen-to-square"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"Sesiones"),o(),n(4,"form",3),P("ngSubmit",function(){return a.onFilter()}),n(5,"div",4)(6,"div",5)(7,"div",6)(8,"button",7),r(9,"Buscar"),o()(),n(10,"div",8)(11,"select",9)(12,"option",10),r(13,"Todas"),o(),y(14,Oe,3,4,"option",11,T),o(),n(16,"div"),c(17,"input",12),o()()(),n(18,"div")(19,"i",13),P("click",function(){return a.goCreateSesion()}),o()()()()(),n(20,"div",14)(21,"table",15)(22,"thead")(23,"tr")(24,"th"),r(25,"Pel\xEDcula"),o(),n(26,"th"),r(27,"Sala"),o(),n(28,"th"),r(29,"Inicio"),o(),n(30,"th"),r(31,"Fin"),o(),n(32,"th"),r(33,"Estado"),o(),c(34,"th"),o()(),n(35,"tbody"),y(36,je,20,17,"tr",null,T),o()()(),p(38,Ue,2,0,"h2",16),o()),t&2&&(l(4),g("formGroup",a.form),l(10),F(a.estadoSesiones()),l(22),F(a.getSesionesResource.value()),l(2),u(a.getSesionesResource.error()?38:-1))},dependencies:[G,J,oe,W,te,ie,ue,ee,K,Q,X,Z],styles:["[_nghost-%COMP%]{display:block}"]})};var qe=()=>[];function He(i,e){i&1&&(n(0,"div",0),U(),n(1,"svg",4),c(2,"path",5),o(),H(),n(3,"span"),r(4,"Ups! Error de eliminaci\xF3n. Revisa que no haya sesiones asociadas"),o()())}function ze(i,e){i&1&&(n(0,"div",0),U(),n(1,"svg",4),c(2,"path",5),o(),H(),n(3,"span"),r(4,"Ups! Ha ocurrido alg\xFAn error al guadar"),o()())}function Ye(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("titulo")," ")}}function Je(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("anio")," ")}}function Ke(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("duracion")," ")}}function Qe(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("trailer")," ")}}function We(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("sinopsis")," ")}}function Xe(i,e){if(i&1&&(n(0,"option",16),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t),l(),C(w(2,2,t))}}function Ze(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("categoria")," ")}}function et(i,e){if(i&1&&(n(0,"option",16),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t),l(),C(w(2,2,t))}}function tt(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("calificacion")," ")}}function it(i,e){if(i&1&&(n(0,"option",16),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t),l(),C(w(2,2,t))}}function nt(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("formato")," ")}}function ot(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("poster")," ")}}function rt(i,e){if(i&1&&(n(0,"span",10),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("imagen")," ")}}function lt(i,e){if(i&1){let t=ce();n(0,"div",3)(1,"form",6),P("ngSubmit",function(){O(t);let s=d();return j(s.save())}),n(2,"fieldset",7)(3,"label",8),r(4,"T\xEDtulo"),o(),c(5,"input",9),p(6,Ye,2,1,"span",10),n(7,"label",8),r(8,"A\xF1o"),o(),c(9,"input",11),p(10,Je,2,1,"span",10),n(11,"label",8),r(12,"Duracion"),o(),c(13,"input",12),p(14,Ke,2,1,"span",10),n(15,"label",8),r(16,"Tr\xE1iler"),o(),c(17,"textarea",13),p(18,Qe,2,1,"span",10),n(19,"label",8),r(20,"Sinopsis"),o(),c(21,"textarea",14),p(22,We,2,1,"span",10),n(23,"label",8),r(24,"Categor\xEDa"),o(),n(25,"select",15),y(26,Xe,3,4,"option",16,T),o(),p(28,Ze,2,1,"span",10),n(29,"label",8),r(30,"Calificaci\xF3n"),o(),n(31,"select",17),y(32,et,3,4,"option",16,T),o(),p(34,tt,2,1,"span",10),n(35,"label",8),r(36,"Formato"),o(),n(37,"select",18),y(38,it,3,4,"option",16,T),o(),p(40,nt,2,1,"span",10),n(41,"label",8),r(42,"P\xF3ster"),o(),c(43,"textarea",19),p(44,ot,2,1,"span",10),n(45,"div",20)(46,"div",21)(47,"label",8),r(48,"Imagen"),o(),c(49,"textarea",22),p(50,rt,2,1,"span",10),o(),c(51,"img",23),o(),n(52,"div",24)(53,"div",25)(54,"button",26),r(55,"Guardar"),o()(),n(56,"div",25)(57,"button",27),r(58," Eliminar "),o(),n(59,"dialog",28)(60,"div",29)(61,"form",30)(62,"h3",31),r(63,"Confirmaci\xF3n!"),o(),n(64,"p",32),r(65),E(66,"titlecase"),o(),n(67,"button",33),r(68," \u2715 "),o(),n(69,"button",34),P("click",function(){O(t);let s=d();return j(s.eliminarPelicula())}),r(70," S\xED, quiero eliminar "),o()()()()()()()()()}if(i&2){let t,a,s,f,A,S,R,k,re,Se,le,ae,me,ve,v,b=d();l(),g("formGroup",b.form),l(5),u((t=b.form.get("titulo"))!=null&&t.invalid&&((t=b.form.get("titulo"))!=null&&t.touched)?6:-1),l(4),u((a=b.form.get("anio"))!=null&&a.invalid&&((a=b.form.get("anio"))!=null&&a.touched)?10:-1),l(4),u((s=b.form.get("duracion"))!=null&&s.invalid&&((s=b.form.get("duracion"))!=null&&s.touched)?14:-1),l(4),u((f=b.form.get("trailer"))!=null&&f.invalid&&((f=b.form.get("anio"))!=null&&f.touched)?18:-1),l(4),u((A=b.form.get("sinopsis"))!=null&&A.invalid&&((A=b.form.get("sinopsis"))!=null&&A.touched)?22:-1),l(4),F((S=(S=b.peliculasResource.value())==null?null:S.categorias)!==null&&S!==void 0?S:z(15,qe)),l(2),u((R=b.form.get("categoria"))!=null&&R.invalid&&((R=b.form.get("categoria"))!=null&&R.touched)?28:-1),l(4),F((k=(k=b.peliculasResource.value())==null?null:k.calificaciones)!==null&&k!==void 0?k:z(16,qe)),l(2),u((re=b.form.get("sinopsis"))!=null&&re.invalid&&((re=b.form.get("calificacion"))!=null&&re.touched)?34:-1),l(4),F((Se=b.peliculasResource.value())==null?null:Se.formatos),l(2),u((le=b.form.get("formato"))!=null&&le.invalid&&((le=b.form.get("formato"))!=null&&le.touched)?40:-1),l(4),u((ae=b.form.get("poster"))!=null&&ae.invalid&&((ae=b.form.get("poster"))!=null&&ae.touched)?44:-1),l(6),u((me=b.form.get("imagen"))!=null&&me.invalid&&((me=b.form.get("imagen"))!=null&&me.touched)?50:-1),l(),g("src",(ve=b.form.get("imagen"))==null?null:ve.value,he),l(14),_(" Est\xE1 seguro de que quiere eliminar ",w(66,13,(v=b.peliculasResource.value())==null||v.pelicula==null?null:v.pelicula.titulo),"? ")}}var Ae=class i{mostrarAlertas=h(!1);infoPelicula=h(void 0);errorEliminar=h(void 0);errorEditar=h(void 0);router=x(D);idPelicula=h(void 0);activatedRoute=x(fe);adminService=x(B);fb=x(ne);eliminar=h(void 0);peliculasResource=I({request:()=>({id:this.idPelicula()}),loader:({request:e})=>e.id?this.adminService.getPeliculaInfo(e.id):q(void 0)});edicionPeliculaResource=I({request:()=>({id:this.idPelicula(),infoPelicula:this.infoPelicula()}),loader:({request:e})=>!e.infoPelicula||!e.id?q(void 0):this.adminService.actualizarPelicula(e.id,e.infoPelicula)});eliminarPeliculaResource=I({request:()=>({id:this.idPelicula(),eliminar:this.eliminar()}),loader:({request:e})=>!e.id||!e.eliminar?q(void 0):this.adminService.eliminarPelicula(e.id)});form;ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{this.idPelicula.set(Number(e.get("id")))})}erroresEdicionEffect=Y(()=>{let e=this.edicionPeliculaResource.error(),t=this.edicionPeliculaResource.hasValue();this.mostrarAlertas&&(console.log(this.edicionPeliculaResource.error()),e&&(this.errorEditar.set(!0),setTimeout(()=>{console.log(),this.errorEditar.set(void 0),this.mostrarAlertas.set(!1)},3e3)),t&&this.goBack())});erroresEliminacionEffect=Y(()=>{let e=this.eliminarPeliculaResource.error(),t=this.eliminarPeliculaResource.hasValue();this.eliminar()&&(console.log(e),console.log(this.eliminarPeliculaResource.error()),e?(this.errorEliminar.set(!0),setTimeout(()=>{console.log(),this.errorEliminar.set(void 0),this.eliminar.set(void 0)},3e3)):t&&(this.eliminar.set(void 0),this.goBack()))});valorForm=Y(()=>{let e=this.peliculasResource.value();console.log(e),e&&e.pelicula&&(this.form=this.fb.group({id:[e.pelicula.id],titulo:[e.pelicula.titulo,[m.required,m.minLength(2)]],anio:[e.pelicula.anio,[m.required,m.pattern(/^\d+$/),m.pattern(/^\d{4}$/),m.min(1880),m.max(new Date().getFullYear()+2)]],duracion:[e.pelicula.duracion,[m.required,m.min(1),m.max(600),,]],sinopsis:[e.pelicula.sinopsis,[m.required,m.minLength(10)]],trailer:[e.pelicula.trailer,m.required],categoria:[e.pelicula.categoria,m.required],calificacion:[e.pelicula.calificacion,m.required],formato:[e.pelicula.formato,m.required],imagen:[e.pelicula.imagen,m.required],poster:[e.pelicula.poster,m.required]}))});save(){if(!this.form.valid){this.form.markAllAsTouched();return}console.log("object");let e=this.form.value;this.infoPelicula.set(e),this.mostrarAlertas.set(!0)}eliminarPelicula(){this.eliminar.set(!0),this.eliminarPeliculaResource.reload(),console.log(this.eliminarPeliculaResource.error())}getFieldError(e){if(!this.form.controls[e])return null;let t=this.form.controls[e].errors??{};for(let a of Object.keys(t))switch(a){case"required":return"Este campo es requerido";case"minlength":return`M\xEDnimo de ${t.minlength.requiredLength} caracteres`;case"min":return`Valor m\xEDnimo de ${t.min.min}`;case"max":return`Valor m\xE1ximo de ${t.max.max}`;case"pattern":return"Debe ser un n\xFAumero v\xE1lido"}return null}goBack(){this.router.navigate(["admin/peliculas"])}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=N({type:i,selectors:[["app-admin-editar-pelicula"]],decls:7,vars:3,consts:[["role","alert",1,"alert","alert-error","w-80","md:w-80","absolute","left-10","md:left-[20%]","z-10"],[1,"flex","flex-col","md:flex-row","md:justify-center","items-center","md:items-start","gap-5","mt-2","md:mt-10","mb-10"],[1,"fa-regular","fa-circle-left","text-[40px]","cursor-pointer",2,"color","#a397c9",3,"click"],[1,"max-h-[80vh]","overflow-y-auto","bg-secondary-content","relative"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"h-6","w-6","shrink-0","stroke-current"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[3,"ngSubmit","formGroup"],[1,"fieldset","bg-[#e9e5f3]","border-base-300","rounded-box","w-xs","md:w-md","border","p-4"],[1,"label"],["type","text","placeholder","My awesome page","formControlName","titulo","readonly","",1,"input","input-md","w-full"],[1,"form-text","text-error"],["type","text","placeholder","my-awesome-page","formControlName","anio",1,"input","input-md","w-full"],["type","text","placeholder","Name","formControlName","duracion",1,"input","input-md","w-full"],["placeholder","Bio","formControlName","trailer",1,"textarea","textarea-xs","w-full"],["placeholder","Bio","formControlName","sinopsis",1,"textarea","textarea-xs","w-full"],["formControlName","categoria",1,"select","w-full"],[3,"value"],["formControlName","calificacion",1,"select","w-full"],["formControlName","formato",1,"select","w-full"],["placeholder","Bio","formControlName","poster",1,"textarea","textarea-xs","w-full"],[1,"flex","gap-3","flex-col","items-center"],[1,"w-full"],["placeholder","Bio","formControlName","imagen",1,"textarea","textarea-xs","w-full"],["alt","P\xF3ster",1,"w-30","rounded",3,"src"],[1,"flex","gap-4","mt-2"],[1,"w-1/2"],[1,"btn","btn-primary","w-full"],["type","button","onclick","my_modal_3.showModal()",1,"btn","btn-error","w-full"],["id","my_modal_3",1,"modal"],[1,"modal-box"],["method","dialog"],[1,"text-lg","font-bold"],[1,"py-4"],[1,"btn","btn-sm","btn-circle","btn-ghost","absolute","right-2","top-2"],[1,"btn","btn-error",3,"click"]],template:function(t,a){t&1&&(p(0,He,5,0,"div",0)(1,ze,5,0,"div",0),n(2,"div",1)(3,"div")(4,"p")(5,"i",2),P("click",function(){return a.goBack()}),o()()(),p(6,lt,71,17,"div",3),o()),t&2&&(u(a.errorEliminar()?0:-1),l(),u(a.errorEditar()?1:-1),l(5),u(a.form?6:-1))},dependencies:[oe,W,te,ie,ue,ee,K,Q,X,Z,G],encapsulation:2})};var Ge=()=>[];function at(i,e){i&1&&(n(0,"div",3),U(),n(1,"svg",5),c(2,"path",6),o(),H(),n(3,"span"),r(4,"Pel\xEDcula creada correctamente!"),o()())}function mt(i,e){i&1&&(n(0,"div",4),U(),n(1,"svg",5),c(2,"path",6),o(),H(),n(3,"span"),r(4,"Algo ha ocurrido:( No se ha podido guardar los cambios"),o()())}function st(i,e){if(i&1&&p(0,at,5,0,"div",3)(1,mt,5,0,"div",4),i&2){let t=d();u(!t.crearPeliculaResource.error()&&t.crearPeliculaResource.hasValue()?0:1)}}function ct(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("titulo")," ")}}function dt(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("anio")," ")}}function ut(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("duracion")," ")}}function pt(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("trailer")," ")}}function ft(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("sinopsis")," ")}}function xt(i,e){if(i&1&&(n(0,"option",17),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t),l(),C(w(2,2,t))}}function _t(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("categoria")," ")}}function gt(i,e){if(i&1&&(n(0,"option",17),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t),l(),C(w(2,2,t))}}function St(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("calificacion")," ")}}function vt(i,e){if(i&1&&(n(0,"option",17),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t),l(),C(w(2,2,t))}}function ht(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("formato")," ")}}function Ct(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("poster")," ")}}function Et(i,e){if(i&1&&(n(0,"span",11),r(1),o()),i&2){let t=d(2);l(),_(" ",t.getFieldError("imagen")," ")}}function bt(i,e){if(i&1){let t=ce();n(0,"div",2)(1,"form",7),P("ngSubmit",function(){O(t);let s=d();return j(s.save())}),n(2,"fieldset",8)(3,"label",9),r(4,"T\xEDtulo"),o(),c(5,"input",10),p(6,ct,2,1,"span",11),n(7,"label",9),r(8,"A\xF1o"),o(),c(9,"input",12),p(10,dt,2,1,"span",11),n(11,"label",9),r(12,"Duracion"),o(),c(13,"input",13),p(14,ut,2,1,"span",11),n(15,"label",9),r(16,"Tr\xE1iler"),o(),c(17,"textarea",14),p(18,pt,2,1,"span",11),n(19,"label",9),r(20,"Sinopsis"),o(),c(21,"textarea",15),p(22,ft,2,1,"span",11),n(23,"label",9),r(24,"Categor\xEDa"),o(),n(25,"select",16),y(26,xt,3,4,"option",17,T),o(),p(28,_t,2,1,"span",11),n(29,"label",9),r(30,"Calificaci\xF3n"),o(),n(31,"select",18),y(32,gt,3,4,"option",17,T),o(),p(34,St,2,1,"span",11),n(35,"label",9),r(36,"Formato"),o(),n(37,"select",19),y(38,vt,3,4,"option",17,T),o(),p(40,ht,2,1,"span",11),n(41,"div")(42,"label",9),r(43,"P\xF3ster"),o(),c(44,"textarea",20),p(45,Ct,2,1,"span",11),o(),n(46,"div",21)(47,"div",22)(48,"label",9),r(49,"Imagen"),o(),c(50,"textarea",23),p(51,Et,2,1,"span",11),o(),c(52,"img",24),o(),n(53,"div",25)(54,"div",22)(55,"button",26),r(56,"Guardar"),o()()()()()()}if(i&2){let t,a,s,f,A,S,R,k,re,Se,le,ae,me,ve,v=d();l(),g("formGroup",v.form),l(5),u((t=v.form.get("titulo"))!=null&&t.invalid&&((t=v.form.get("titulo"))!=null&&t.touched)?6:-1),l(4),u((a=v.form.get("anio"))!=null&&a.invalid&&((a=v.form.get("anio"))!=null&&a.touched)?10:-1),l(4),u((s=v.form.get("duracion"))!=null&&s.invalid&&((s=v.form.get("duracion"))!=null&&s.touched)?14:-1),l(4),u((f=v.form.get("trailer"))!=null&&f.invalid&&((f=v.form.get("trailer"))!=null&&f.touched)?18:-1),l(4),u((A=v.form.get("sinopsis"))!=null&&A.invalid&&((A=v.form.get("sinopsis"))!=null&&A.touched)?22:-1),l(4),F((S=(S=v.peliculasResource.value())==null?null:S.categorias)!==null&&S!==void 0?S:z(12,Ge)),l(2),u((R=v.form.get("categoria"))!=null&&R.invalid&&((R=v.form.get("categoria"))!=null&&R.touched)?28:-1),l(4),F((k=(k=v.peliculasResource.value())==null?null:k.calificaciones)!==null&&k!==void 0?k:z(13,Ge)),l(2),u((re=v.form.get("calificacion"))!=null&&re.invalid&&((re=v.form.get("calificacion"))!=null&&re.touched)?34:-1),l(4),F((Se=v.peliculasResource.value())==null?null:Se.formatos),l(2),u((le=v.form.get("formato"))!=null&&le.invalid&&((le=v.form.get("formato"))!=null&&le.touched)?40:-1),l(5),u((ae=v.form.get("poster"))!=null&&ae.invalid&&((ae=v.form.get("poster"))!=null&&ae.touched)?45:-1),l(6),u((me=v.form.get("imagen"))!=null&&me.invalid&&((me=v.form.get("imagen"))!=null&&me.touched)?51:-1),l(),g("src",(ve=v.form.get("imagen"))==null?null:ve.value,he)}}var Te=class i{infoPelicula=h(void 0);router=x(D);fb=x(ne);adminService=x(B);form;mostrarAlertas=h(!1);ngOnInit(){this.form=this.fb.group({titulo:["",[m.required,m.minLength(2)]],anio:["",[m.required,m.pattern(/^\d+$/),m.pattern(/^\d{4}$/),m.min(1880),m.max(new Date().getFullYear()+2)]],duracion:["",[m.required,m.min(1),m.max(600),m.pattern(/^\d+$/)]],sinopsis:["",[m.required,m.minLength(10)]],trailer:["",m.required],categoria:["",m.required],calificacion:["",m.required],formato:["",m.required],imagen:["",m.required],poster:["",m.required]})}peliculasResource=I({request:()=>({}),loader:({request:e})=>this.adminService.getPeliculaParametersInfo()});crearPeliculaResource=I({request:()=>({pelicula:this.infoPelicula()}),loader:({request:e})=>e.pelicula?this.adminService.postPelicula(e.pelicula):q(void 0)});getFieldError(e){if(!this.form.controls[e])return null;let t=this.form.controls[e].errors??{};for(let a of Object.keys(t))switch(a){case"required":return"Este campo es requerido";case"minlength":return`M\xEDnimo de ${t.minlength.requiredLength} caracteres`;case"min":return`Valor m\xEDnimo de ${t.min.min}`;case"max":return`Valor m\xE1ximo de ${t.max.max}`;case"pattern":return"Debe ser un n\xFAumero v\xE1lido"}return null}save(){if(this.form.invalid){this.form.markAllAsTouched();return}let e=this.form.value;this.infoPelicula.set(e),this.mostrarAlertas.set(!0),setTimeout(()=>{this.mostrarAlertas.set(!1)},2e3),this.form.reset(),console.log(this.infoPelicula())}goBack(){this.router.navigate(["admin/peliculas"])}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=N({type:i,selectors:[["app-admin-crear-pelicula"]],decls:6,vars:2,consts:[[1,"flex","flex-col","md:flex-row","md:justify-center","items-center","md:items-start","gap-5","mt-2","md:mt-10","mb-10"],[1,"fa-regular","fa-circle-left","text-[40px]","cursor-pointer",2,"color","#a397c9",3,"click"],[1,"max-h-[80vh]","overflow-y-auto","bg-secondary-content","relative"],["role","alert",1,"alert","alert-success","w-80","md:w-80","absolute","left-10","md:left-[20%]","z-10"],["role","alert",1,"alert","alert-success","w-100","absolute","left-70"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"h-6","w-6","shrink-0","stroke-current"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],[3,"ngSubmit","formGroup"],[1,"fieldset","bg-[#e9e5f3]","border-base-300","rounded-box","w-xs","md:w-md","border","p-4"],[1,"label"],["type","text","placeholder","","formControlName","titulo",1,"input","input-md","w-full"],[1,"form-text","text-error"],["type","text","placeholder","","formControlName","anio",1,"input","input-md","w-full"],["type","text","placeholder","","formControlName","duracion",1,"input","input-md","w-full"],["placeholder","Bio","formControlName","trailer",1,"textarea","textarea-xs","w-full"],["placeholder","","formControlName","sinopsis",1,"textarea","textarea-xs","w-full"],["formControlName","categoria",1,"select","w-full"],[3,"value"],["formControlName","calificacion",1,"select","w-full"],["formControlName","formato",1,"select","w-full"],["placeholder","URL de P\xF3ster","formControlName","poster",1,"textarea","textarea-xs","w-full"],[1,"flex","gap-3","flex-col","items-center"],[1,"w-full"],["placeholder","URL de imagen","formControlName","imagen",1,"textarea","textarea-xs","w-full"],["alt","Imagen",1,"w-30","rounded",3,"src"],[1,"flex","items-center","justify-center","gap-4","mt-2"],[1,"btn","btn-primary","w-full"]],template:function(t,a){t&1&&(p(0,st,2,1),n(1,"div",0)(2,"div")(3,"p")(4,"i",1),P("click",function(){return a.goBack()}),o()()(),p(5,bt,57,14,"div",2),o()),t&2&&(u(a.mostrarAlertas()?0:-1),l(5),u(a.form?5:-1))},dependencies:[G,oe,W,te,ie,ue,ee,K,Q,X,Z],styles:["[_nghost-%COMP%]{display:block}"]})};function Pt(i,e){i&1&&(n(0,"div",13),U(),n(1,"svg",14),c(2,"path",15),o(),H(),n(3,"span"),r(4,"No se ha podido guardar los cambios"),o()())}function wt(i,e){if(i&1&&p(0,Pt,5,0,"div",13),i&2){let t=d();u(t.putSesionResource.error()?0:-1)}}function At(i,e){if(i&1&&(n(0,"span",7),r(1),o()),i&2){let t=d();l(),_(" ",t.getFieldError("estado")," ")}}function Tt(i,e){if(i&1&&(n(0,"option",9),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t),l(),C(w(2,2,t))}}var ye=class i{errorEditar;errorEliminar;goBack(){this.router.navigate(["admin/sesiones"])}infoPutSesion=h(void 0);estadoSesiones=h(["ACTIVA","CANCELADA","TERMINADA","PROGRAMADA"]);idSesion=h(void 0);eliminar=h(void 0);router=x(D);activatedRoute=x(fe);adminService=x(B);fb=x(ne);form;mostrarAlertas=h(void 0);comprobarEstadoCreacion=Y(()=>{let e=this.putSesionResource.hasValue(),t=this.putSesionResource.error();e&&this.goBack(),this.mostrarAlertas.set(!0),setTimeout(()=>{this.mostrarAlertas.set(!1)},2e3)});ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{this.idSesion.set(Number(e.get("id"))),console.log(this.idSesion)}),this.form=this.fb.group({id:[""],pelicula:["",m.required],sala:["",m.required],estado:["",m.required],inicio:["",m.required]})}getInfoSesionResource=I({request:()=>({id:this.idSesion()}),loader:({request:e})=>e.id?this.adminService.getSesion(e.id):q(void 0)});putSesionResource=I({request:()=>({id:this.idSesion(),infoSesion:this.infoPutSesion()}),loader:({request:e})=>!e.id||!e.infoSesion?q(void 0):this.adminService.putSesion(e.infoSesion,e.id)});valorForm=Y(()=>{let e=this.getInfoSesionResource.value();console.log(e),e&&e.sesion&&(this.form=this.fb.group({id:[e.sesion.id],pelicula:[e.sesion.pelicula,m.required],sala:[e.sesion.sala,m.required],estado:[e.sesion.estado,m.required]}))});getFieldError(e){if(!this.form.controls[e])return null;let t=this.form.controls[e].errors??{};for(let a of Object.keys(t))switch(a){case"required":return"Este campo es requerido";case"minlength":return`M\xEDnimo de ${t.minlength.requiredLength} caracteres`;case"min":return`Valor m\xEDnimo de ${t.min.min}`;case"max":return`Valor m\xE1ximo de ${t.max.max}`;case"pattern":return"Debe ser un n\xFAumero v\xE1lido"}return null}save(){if(!this.form.valid)return;let e=this.form.value,t=this.getInfoSesionResource.value()?.peliculas,a=this.getInfoSesionResource.value()?.salas,s=t?.find(S=>S.titulo===e.pelicula),f=a?.find(S=>S.nombre===e.sala);if(!s||!f){console.error("No encontrada la sala o pelicula");return}let A={id:e.id,idPelicula:s.id,idSala:f.id,estado:e.estado,inicio:void 0};this.infoPutSesion.set(A)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=N({type:i,selectors:[["app-admin-editar-sesion"]],decls:32,vars:13,consts:[[1,"flex","flex-col","md:flex-row","md:justify-center","items-center","md:items-start","gap-5","mt-2","md:mt-10","mb-10"],[1,"fa-regular","fa-circle-left","text-[40px]","cursor-pointer",2,"color","#a397c9",3,"click"],[1,"max-h-[80vh]","overflow-y-auto","bg-secondary-content","relative"],[3,"ngSubmit","formGroup"],[1,"fieldset","bg-[#e9e5f3]","border-base-300","rounded-box","w-xs","md:w-md","border","p-4"],[1,"label"],["type","text","readonly","",1,"input","input-md","w-full",3,"value"],[1,"form-text","text-error"],["formControlName","estado",1,"select","w-full"],[3,"value"],[1,"flex","gap-4","mt-2"],[1,"w-full"],[1,"btn","btn-primary","w-full"],["role","alert",1,"alert","alert-error","w-80","md:w-80","absolute","left-10","md:left-[20%]","z-10"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"h-6","w-6","shrink-0","stroke-current"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"]],template:function(t,a){if(t&1&&(p(0,wt,1,1),n(1,"div",0)(2,"div")(3,"p")(4,"i",1),P("click",function(){return a.goBack()}),o()()(),n(5,"div",2)(6,"form",3),P("ngSubmit",function(){return a.save()}),n(7,"fieldset",4)(8,"label",5),r(9,"Pel\xEDcula"),o(),c(10,"input",6),n(11,"label",5),r(12,"Inicio"),o(),c(13,"input",6),E(14,"date"),n(15,"label",5),r(16,"Fin"),o(),c(17,"input",6),E(18,"date"),p(19,At,2,1,"span",7),n(20,"label",5),r(21,"Sala"),o(),c(22,"input",6),n(23,"label",5),r(24,"Estado"),o(),n(25,"select",8),y(26,Tt,3,4,"option",9,T),o(),n(28,"div",10)(29,"div",11)(30,"button",12),r(31,"Guardar"),o()()()()()()()),t&2){let s,f,A,S,R;u(a.mostrarAlertas()?0:-1),l(6),g("formGroup",a.form),l(4),g("value",(s=a.getInfoSesionResource.value())==null||s.sesion==null?null:s.sesion.pelicula),l(3),g("value",de(14,7,(f=a.getInfoSesionResource.value())==null||f.sesion==null?null:f.sesion.inicio,"medium")),l(4),g("value",de(18,10,(A=a.getInfoSesionResource.value())==null||A.sesion==null?null:A.sesion.fin,"medium")),l(2),u((S=a.form.get("estado"))!=null&&S.invalid&&((S=a.form.get("estado"))!=null&&S.touched)?19:-1),l(3),g("value",(R=a.getInfoSesionResource.value())==null||R.sesion==null?null:R.sesion.sala),l(4),F(a.estadoSesiones())}},dependencies:[G,oe,W,te,ie,ee,K,Q,X,Z,J],styles:["[_nghost-%COMP%]{display:block}"]})};var yt=()=>[];function Ft(i,e){i&1&&(n(0,"div",16),U(),n(1,"svg",17),c(2,"path",18),o(),H(),n(3,"span"),r(4,"Sesi\xF3n creada correctamente!"),o()())}function Rt(i,e){i&1&&(n(0,"div",19),U(),n(1,"svg",17),c(2,"path",18),o(),H(),n(3,"span"),r(4,"No se ha podido crear la sesi\xF3n"),o()())}function It(i,e){if(i&1&&p(0,Rt,5,0,"div",19),i&2){let t=d(2);u(t.crearSesionResource.error()?0:-1)}}function kt(i,e){if(i&1&&p(0,Ft,5,0,"div",16)(1,It,1,1),i&2){let t=d();u(t.crearSesionResource.hasValue()?0:1)}}function Nt(i,e){if(i&1&&(n(0,"option",7),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t.titulo),l(),C(w(2,2,t.titulo))}}function Dt(i,e){if(i&1&&(n(0,"span",8),r(1),o()),i&2){let t=d();l(),_(" ",t.getFieldError("pelicula")," ")}}function Bt(i,e){if(i&1&&(n(0,"span",8),r(1),o()),i&2){let t=d();l(),_(" ",t.getFieldError("inicio")," ")}}function Mt(i,e){if(i&1&&(n(0,"option",7),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t.nombre),l(),C(w(2,2,t.nombre))}}function Vt(i,e){if(i&1&&(n(0,"span",8),r(1),o()),i&2){let t=d();l(),_(" ",t.getFieldError("sala")," ")}}function $t(i,e){if(i&1&&(n(0,"option",7),r(1),E(2,"titlecase"),o()),i&2){let t=e.$implicit;g("value",t),l(),C(w(2,2,t))}}function qt(i,e){if(i&1&&(n(0,"span",8),r(1),o()),i&2){let t=d();l(),_(" ",t.getFieldError("estado")," ")}}var Fe=class i{datePipe=x(J);goBack(){this.router.navigate(["admin/sesiones"])}infoPutSesion=h(void 0);estadoSesiones=h(["PROGRAMADA"]);eliminar=h(void 0);router=x(D);activatedRoute=x(fe);adminService=x(B);fb=x(ne);form;fechaBuscar=h(void 0);sala=h(void 0);fechaSiguiente=h(void 0);getInfoSesionPostResource=I({request:()=>({}),loader:({request:e})=>this.adminService.getInfoPostSesion()});valorForm=Y(()=>{let e=this.getInfoSesionPostResource.value();e&&e.sesion&&(this.form=this.fb.group({id:[0],pelicula:[this.getInfoSesionPostResource.value()?.peliculas[0],m.required],sala:["",m.required],estado:["",m.required],inicio:["",m.required],inicioRespuesta:[""]}))});obtenerValorFechaSiguiente=Y(()=>{let e=this.obtenerSiguienteFechaResource.value();this.fechaSiguiente.set(e),console.log(this.fechaSiguiente())});getFieldError(e){if(!this.form.controls[e])return null;let t=this.form.controls[e].errors??{};for(let a of Object.keys(t))switch(a){case"required":return"Este campo es requerido";case"minlength":return`M\xEDnimo de ${t.minlength.requiredLength} caracteres`;case"min":return`Valor m\xEDnimo de ${t.min.min}`;case"max":return`Valor m\xE1ximo de ${t.max.max}`;case"pattern":return"Debe ser un n\xFAumero v\xE1lido"}return null}save(){if(!this.form.valid){this.form.markAllAsTouched();return}let e=this.form.value,t=this.getInfoSesionPostResource.value()?.peliculas,a=this.getInfoSesionPostResource.value()?.salas,s=t?.find(S=>S.titulo===e.pelicula),f=a?.find(S=>S.nombre===e.sala);if(!s||!f){console.error("No encontrada la sala o pelicula");return}let A={id:e.id,idPelicula:s.id,idSala:f.id,estado:e.estado,inicio:this.datePipe.transform(this.fechaSiguiente(),"yyyy-MM-ddTHH:mm")};this.infoPutSesion.set(A),this.form.reset(),this.form.patchValue({estado:"PROGRAMADA"})}obtenerSiguienteFechaResource=I({request:()=>({fecha:this.fechaBuscar(),sala:this.sala()}),loader:({request:e})=>{if(!e.fecha||!e.sala)return q(void 0);let t=this.datePipe.transform(e.fecha,"yyyy-MM-ddTHH:mm");return this.adminService.getSiguienteFechaDisponibleSesion(t,e.sala)}});crearSesionResource=I({request:()=>({infoSesion:this.infoPutSesion()}),loader:({request:e})=>e.infoSesion?this.adminService.crearSesion(e.infoSesion):q(void 0)});mostrarAlertas=h(void 0);comprobarEstadoCreacion=Y(()=>{let e=this.crearSesionResource.hasValue();console.log(e),this.mostrarAlertas.set(!0),setTimeout(()=>{this.mostrarAlertas.set(!1)},2e3)});ngOnInit(){this.form=this.fb.group({id:[0],pelicula:["",m.required],sala:["",m.required],estado:["PROGRAMADA",m.required],inicio:["",m.required],inicioRespuesta:[""]}),this.form.valueChanges.subscribe(e=>{let{sala:t,inicio:a}=e;t&&a&&(console.log(t,a),this.sala.set(t),this.fechaBuscar.set(new Date(a)))})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=N({type:i,selectors:[["app-admin-crear-sesion"]],features:[Ce([J])],decls:38,vars:11,consts:[[1,"flex","flex-col","md:flex-row","md:justify-center","items-center","md:items-start","gap-5","mt-2","md:mt-10","mb-10"],[1,"fa-regular","fa-circle-left","text-[40px]","cursor-pointer",2,"color","#a397c9",3,"click"],[1,"max-h-[80vh]","overflow-y-auto","bg-secondary-content","relative"],[3,"ngSubmit","formGroup"],[1,"fieldset","bg-[#e9e5f3]","border-base-300","rounded-box","w-xs","md:w-md","border","p-4"],[1,"label"],["formControlName","pelicula",1,"select","w-full"],[3,"value"],[1,"form-text","text-error"],["type","date","formControlName","inicio",1,"input","w-full"],["formControlName","sala",1,"select","w-full"],["type","text","readonly","",1,"input","input-md","w-full",3,"value"],["formControlName","estado",1,"select","w-full"],[1,"flex","gap-4","mt-2"],[1,"w-full"],[1,"btn","btn-primary","w-full"],["role","alert",1,"alert","alert-success","w-80","md:w-80","absolute","left-10","md:left-[20%]","z-10"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"h-6","w-6","shrink-0","stroke-current"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"],["role","alert",1,"alert","alert-error","w-80","md:w-80","absolute","left-10","md:left-[20%]","z-10"]],template:function(t,a){if(t&1&&(p(0,kt,2,1),n(1,"div",0)(2,"div")(3,"p")(4,"i",1),P("click",function(){return a.goBack()}),o()()(),n(5,"div",2)(6,"form",3),P("ngSubmit",function(){return a.save()}),n(7,"fieldset",4)(8,"label",5),r(9,"Pel\xEDcula"),o(),n(10,"select",6),y(11,Nt,3,4,"option",7,T),o(),p(13,Dt,2,1,"span",8),n(14,"label",5),r(15,"Fecha de la sesi\xF3n"),o(),c(16,"input",9),p(17,Bt,2,1,"span",8),n(18,"label",5),r(19,"Sala"),o(),n(20,"select",10),y(21,Mt,3,4,"option",7,T),o(),p(23,Vt,2,1,"span",8),n(24,"label",5),r(25,"Fecha de inicio"),o(),c(26,"input",11),E(27,"date"),n(28,"label",5),r(29,"Estado"),o(),n(30,"select",12),y(31,$t,3,4,"option",7,T),o(),p(33,qt,2,1,"span",8),n(34,"div",13)(35,"div",14)(36,"button",15),r(37,"Guardar"),o()()()()()()()),t&2){let s,f,A,S,R,k;u(a.mostrarAlertas()?0:-1),l(6),g("formGroup",a.form),l(5),F((s=a.getInfoSesionPostResource.value())==null?null:s.peliculas),l(2),u((f=a.form.get("pelicula"))!=null&&f.invalid&&((f=a.form.get("pelicula"))!=null&&f.touched)?13:-1),l(4),u((A=a.form.get("inicio"))!=null&&A.invalid&&((A=a.form.get("inicio"))!=null&&A.touched)?17:-1),l(4),F((S=(S=a.getInfoSesionPostResource.value())==null?null:S.salas)!==null&&S!==void 0?S:z(10,yt)),l(2),u((R=a.form.get("sala"))!=null&&R.invalid&&((R=a.form.get("sala"))!=null&&R.touched)?23:-1),l(3),g("value",de(27,7,a.fechaSiguiente(),"medium")),l(5),F(a.estadoSesiones()),l(2),u((k=a.form.get("estado"))!=null&&k.invalid&&((k=a.form.get("estado"))!=null&&k.touched)?33:-1)}},dependencies:[G,J,oe,W,te,ie,ue,ee,K,Q,X,Z],styles:["[_nghost-%COMP%]{display:block}"]})};var Gt=[{path:"",component:Ee,children:[{path:"peliculas",component:be},{path:"peliculas/crear",component:Te},{path:"peliculas/:id",component:Ae},{path:"sesiones",component:Pe},{path:"sesiones/crear",component:Fe},{path:"sesiones/:id",component:ye},{path:"**",redirectTo:"peliculas"}]}],fn=Gt;export{Gt as adminRoutes,fn as default};
