import{a as Me}from"./chunk-I6JCDLCP.js";import{c as Le,d as Re,e as Oe,f as De,g as Ie,h as Ve,i as ze,j as Ae,k as Ne,l as $e}from"./chunk-U2FPY7MB.js";import{$ as u,A as z,Aa as we,B as v,D as m,E as K,Ea as Pe,F as _e,Fa as ke,G as s,Ga as re,Ha as Fe,I as Ce,Ia as U,J as _,N as y,Na as F,P as h,R as de,S,T as Se,U as B,V as E,W as w,X as a,Y as o,Z as d,_ as C,a as q,aa as p,b as ge,ba as ue,ca as l,da as b,ea as H,f as N,fa as be,g as M,ha as ye,i as $,ia as R,ja as Q,k as xe,ka as Y,l as L,la as fe,m as X,n as V,pa as Te,q as he,qa as k,sa as J,t as f,ta as Ee,u as ve,ua as ee,v as g,va as te,w as x,wa as ie,x as j,y as Z}from"./chunk-7GXU7I4D.js";var D=class{static mapRESTFilmToFilm=t=>({id:t.id,titulo:t.titulo,categoria:t.categoria,anio:t.anio,calificacion:t.calificacion,duracion:t.duracion,formato:t.formato,imagen:t.imagen,poster:t.poster,sinopsis:t.sinopsis,trailer:t.trailer,sesiones:this.mapRestSesionArrayToSesionArray(t.sesiones)});static mapRestSesionArrayToSesionArray(t){return t.map(e=>({id:e.id,inicio:e.inicio,salaId:e.salaId}))}static mapRESTfilmArrayToFilmArray=t=>t.map(this.mapRESTFilmToFilm);static mapRESTfechasToFechas=t=>({listaFechas:t.listaFechas});static mapRESTTarifaToTarifa=t=>({nombre:t.nombre,precio:t.precio});static mapRESTarifaArrayToTarifaArray=t=>t.map(this.mapRESTTarifaToTarifa);static mapTarifasSeleccionadasToRESTTarifasSeleccionadas=t=>{let e=[];for(let i of Object.values(t))e.push({nombre:i.nombre,cantidad:i.cantidad});return e};static mapRESTDetalleToDetalle=t=>({butacas:t.butacas,fecha:t.fecha,sala:t.sala,total:t.total,pelicula:t.pelicula,tarifas:t.tarifas});static mapRESTDetalleArrayToDetalleArray=t=>t.map(this.mapRESTDetalleToDetalle)};var O="/api/cartelera";var T=class r{http=f(we);cacheTarifas=void 0;totalTarifas=m(0);loadFromLocalStorage(){let t=localStorage.getItem("seleccion")??"{}";return JSON.parse(t)}saveToLocalStorage(t){localStorage.setItem("seleccion",JSON.stringify(t))}setCacheTarifas(t){this.cacheTarifas=t}getCacheTarifas(){return this.cacheTarifas}setTotalTarifas(t){this.totalTarifas.set(t)}getTotalTarifas(){return this.totalTarifas()}searchCartelera(t){return t?this.http.get(`${O}?dia=${t}`).pipe($(D.mapRESTfilmArrayToFilmArray),X(200),L(e=>M(()=>new Error("No se pudo obtener la cartelera")))):this.http.get(`${O}`).pipe($(D.mapRESTfilmArrayToFilmArray),X(200),V(e=>console.log(e)),L(e=>M(()=>new Error("No se pudo obtener la cartelera"))))}getDates(t){return this.http.get(`${O}/fechas?cantidad=${t}`).pipe($(D.mapRESTfechasToFechas),L(e=>M(()=>new Error("No se pudo obtener los d\xEDas"))))}getTarifas(){return this.http.get(`${O}/tarifas`).pipe($(D.mapRESTarifaArrayToTarifaArray),X(200),V(t=>console.log("res:",t)),L(t=>M(()=>new Error("Error al obtener las tarifas"))))}postSelectedTarifas(t,e,i){if(i){let n=this.loadFromLocalStorage();if(n.idCompra)return this.http.post(`${O}/compra/${e}?idCompra=${n.idCompra}`,t).pipe(V(c=>{let P=ge(q({},n),{tarifas:t,idCompra:c.compraId});console.log(P),this.saveToLocalStorage(P)}),L(c=>M(()=>new Error("Error al empezar la compra"))))}return this.http.post(`${O}/compra/${e}`,t).pipe(V(n=>{console.log(n);let c={tarifas:t,idCompra:n.compraId,estado:1};this.saveToLocalStorage(c)}),L(n=>M(()=>new Error("Error al empezar la compra"))))}postFinalSelection(t){let e=this.loadFromLocalStorage();return console.log({tarifas:e.tarifas,idCompra:e.idCompra,asientosSeleccionados:t}),console.log(`${O}/compra/intermedio/${e.idCompra}`),this.http.post(`${O}/compra/intermedio/${e.idCompra}`,{tarifas:e.tarifas,idCompra:e.idCompra,asientosSeleccionados:t}).pipe(V(i=>{console.log(i),this.saveToLocalStorage({tarifas:e.tarifas,idCompra:e.idCompra,asientosSeleccionados:t,estado:2})}),L(i=>(console.log(i),M(()=>new Error("Error de reserva")))))}cancelarCompra(){let t=this.loadFromLocalStorage();return this.http.post(`${O}/compra/cancelar/${t.idCompra}`,{}).pipe(V(e=>{console.log(e+"COMPRA CANCELADAA ")}),L(e=>M(()=>new Error("Error al empezar la compra"))))}getDetalleCompra(){let t=this.loadFromLocalStorage();return this.http.get(`${O}/compra/detalle/${t.idCompra}`).pipe($(e=>D.mapRESTDetalleToDetalle(e)),V(e=>console.log(e)),L(e=>M(()=>new Error("Error al empezar la compra"))))}postFinalizarCompra(){console.log("Va a finalizar");let t=this.loadFromLocalStorage();return this.http.post(`${O}/compra/finalizar/${t.idCompra}`,{}).pipe(V(e=>console.log(e)),L(e=>M(()=>new Error("Error al empezar la compra"))))}static \u0275fac=function(e){return new(e||r)};static \u0275prov=he({token:r,factory:r.\u0275fac,providedIn:"root"})};var je={baseUrlImages:"/img/"};var He=r=>({display:r}),Be=(r,t)=>t.id;function Ue(r,t){if(r&1&&(a(0,"option",13),l(1),R(2,"date"),o()),r&2){let e=t.$implicit;h("ngValue",e),s(),H(" ",Y(2,2,e,"EEEE, d 'de' MMMM")," ")}}function Ge(r,t){r&1&&(a(0,"div",16),d(1,"span",22),o())}function qe(r,t){r&1&&(a(0,"h2",17),l(1,"No se encontraron resultados para ese d\xEDa :("),o())}function Ke(r,t){if(r&1){let e=C();a(0,"div",26)(1,"h2",27),l(2),o()(),a(3,"p",28),l(4,"No hay sesiones disponibles"),o(),a(5,"div",29)(6,"button",30),u("click",function(){g(e);let n=p().$implicit,c=p();return x(c.onHandleClickTrailer(n.trailer))}),l(7," Trailer "),j(),a(8,"svg",31),d(9,"path",32),o()()()}if(r&2){let e=p().$implicit;s(2),H(" ",e.titulo," ")}}function Je(r,t){if(r&1){let e=C();a(0,"div",39),u("click",function(){let n=g(e).$implicit,c=p(3);return x(c.onHandleClickSession(n.id))}),a(1,"p"),l(2),o()()}if(r&2){let e=t.$implicit,i=p(3);s(2),b(i.transformDate(e.inicio))}}function Qe(r,t){if(r&1){let e=C();a(0,"div",33)(1,"div",26)(2,"p",34),l(3),o()(),a(4,"div")(5,"p",35),l(6),R(7,"date"),o()(),a(8,"div",36)(9,"div",37),E(10,Je,3,1,"div",38,Be),o()()(),a(12,"div",29)(13,"button",30),u("click",function(){g(e);let n=p().$implicit,c=p();return x(c.onHandleClickTrailer(n.trailer))}),l(14," Trailer "),j(),a(15,"svg",31),d(16,"path",32),o()()()}if(r&2){let e=p().$implicit,i=p();s(3),H(" ",e.titulo," "),s(3),H(" ",Y(7,2,i.dateSelected,"EEEE, d 'de' MMMM"),""),s(4),w(e.sesiones)}}function Ye(r,t){if(r&1){let e=C();a(0,"div",20)(1,"div",23),u("mouseenter",function(n){let c=g(e).$implicit,P=p();return x(P.onMouseOverFilm(n,c.id))})("mouseleave",function(){g(e);let n=p();return x(n.onMouseLeaveFilm())}),a(2,"div",24),y(3,Ke,10,1)(4,Qe,17,5),o(),d(5,"img",25),o()()}if(r&2){let e=t.$implicit,i=p();s(2),h("ngClass",i.idFilmSelected()===e.id?"opacity-100":"opacity-0"),s(),S(e.sesiones.length===0?3:4),s(2),h("ngClass",i.idFilmSelected()===e.id?"opacity-0":"opacity-100")("src",e.imagen,K)("alt",e.titulo)}}function We(r,t){if(r&1){let e=C();a(0,"div",40),u("click",function(){g(e);let n=p();return x(n.isOpenModal.set(!1))}),a(1,"div",41)(2,"span",42),l(3,"\xD7"),o(),a(4,"div",43),d(5,"iframe",44),o()()()}if(r&2){let e=p();h("ngStyle",ye(2,He,e.isOpenModal()===!0?"flex":"none")),s(5),h("src",e.trailer(),_e)}}var ae=class r{constructor(t){this.sanitizer=t;k(()=>{let i=this.carteleraResource.value()?.listaFechas??[];i.length>0&&!this.form.value.fecha&&this.form.patchValue({fecha:i[0]}),console.log(this.films())})}fb=f(Ne);router=f(U);dia=new z;datePipe=f(te);form=this.fb.group({fecha:[null]});carteleraService=f(T);cantidadFechas=7;dateSelected=new Date;films=v();errorMessage=v();isLoading=v(!1);isEmpty=v(!1);hovering=m(!1);isOver=m(!1);idFilmSelected=m(-1);carteleraResource=F({loader:()=>this.carteleraService.getDates(this.cantidadFechas)});trailer=m("");valueResource=this.carteleraResource.value();isOpenModal=m(!1);onMouseLeaveFilm(){this.hovering.set(!1),this.idFilmSelected.set(-1),console.log(this.idFilmSelected()),console.log(this.idFilmSelected())}onMouseOverFilm(t,e){this.hovering.set(!0),t.stopPropagation(),this.idFilmSelected.set(e)}transformDate(t){let e=new Date(t),i=e.getHours().toString().padStart(2,"0"),n=e.getMinutes().toString().padStart(2,"0");return`${i}:${n}`}onSubmit(){let t=this.form.value.fecha;console.log(t),this.dateSelected=t;let e=new Date(this.dateSelected??""),i=this.datePipe.transform(e??"","yyyy-MM-ddTHH:mm");this.dia.emit(i??void 0)}getImagenUrl(t){return`${je.baseUrlImages}${t}`}onHandleClickTrailer(t){this.isOpenModal.set(!0);let e=this.sanitizer.bypassSecurityTrustResourceUrl(t);this.trailer.set(e)}onHandleClickSession(t){this.router.navigate(["cartelera/sesion",t])}static \u0275fac=function(e){return new(e||r)(Ce(Pe))};static \u0275cmp=_({type:r,selectors:[["app-lista-peliculas"]],inputs:{films:[1,"films"],errorMessage:[1,"errorMessage"],isLoading:[1,"isLoading"],isEmpty:[1,"isEmpty"]},outputs:{dia:"dia"},features:[be([te])],decls:29,vars:4,consts:[[1,"flex","w-full","flex-col","mt-15","max-w-[1200px]","mx-auto"],[1,"divider","divider-error"],[1,"text-2xl","md:text-4xl"],[1,"text-red-500","font-semibold"],[1,"w-full","h-40","md:h-28","info","max-w-[1200px]","mx-auto","flex","flex-col","justify-center"],[1,"text-white","text-2xl","mb-2"],[1,"flex","items-center","justify-center"],[3,"ngSubmit","formGroup"],[1,"fieldset","flex","flex-col","items-center","justify-center","md:flex-row","my-0"],[1,"flex","flex-row","justify-center","items-center"],[1,"mr-2","my-0"],[1,"fieldset-legend","mb-0","text-[18px]","font-normal","text-white"],["formControlName","fecha",1,"select","select-md","select-error","text-black","bg-[#d9d9d9]"],[3,"ngValue"],[1,"mt-2","md:mt-0"],["type","submit",1,"btn","btn-error","bg-red-600","border-red-600","w-[120px]","text-white"],[1,"flex","flex-col","items-center","justify-center","my-20"],[1,"text-xl","mt-6"],[1,"min-h-[600px]"],[1,"grid-peliculas","mx-auto","max-w-[1200px]","mt-10"],[1,"relative","h-[312px]","rounded-[6px]","bg-black"],["id","ventanaModal",1,"modal-1",3,"ngStyle"],[1,"loader"],[1,"w-[220px]","mt-5",3,"mouseenter","mouseleave"],[1,"absolute","top-0","left-0","w-full","h-full","bg-black","transition-opacity","duration-500","pt-4","pb-4","rounded-[5px]","border-2","border-red-600","z-10","flex","flex-col","justify-between",3,"ngClass"],[1,"absolute","top-0","left-0","h-full","object-cover","transition-opacity","duration-500","w-full","rounded-[5px]",3,"ngClass","src","alt"],[1,"px-[10px]"],[1,"text-[18px]","font-medium","m-0","mb-4","text-red-600","cursor-pointer"],[1,"text-xl","text-red-600"],[1,"px-4"],[1,"px-4","flex","items-center","cursor-pointer","justify-center","gap-1","py-1","border-2","border-red-600","text-red-600","rounded-full","font-semibold","tracking-wide","hover:bg-red-600","hover:text-white","transition-colors","duration-500",3,"click"],["fill","#000000","height","15px","width","15px","version","1.1","id","Capa_1","xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","viewBox","0 0 210 210",0,"xml","space","preserve",1,"fill-current","mt-[3px]"],["d","M179.07,105L30.93,210V0L179.07,105z"],[1,"flex","flex-col","items-center","gap-2"],[1,"text-[18px]","font-medium","m-0","mb-1","text-red-600","cursor-pointer"],[1,"text-white"],[1,"w-full","flex","justify-center"],[1,"flex","gap-2","items-center","justify-center","flex-wrap"],[1,"cursor-pointer","hover:bg-white","active:bg-white","hover:text-red-600","w-auto","px-[8px]","py-[3px]","bg-red-600","transition-colors","duration-300"],[1,"cursor-pointer","hover:bg-white","active:bg-white","hover:text-red-600","w-auto","px-[8px]","py-[3px]","bg-red-600","transition-colors","duration-300",3,"click"],["id","ventanaModal",1,"modal-1",3,"click","ngStyle"],[1,"px-2","md:contenido-modal","max-w-[1000px]","w-full"],[1,"close","text-black"],[1,"w-full","aspect-video"],["title","YouTube video player","frameborder","0","allowfullscreen","",1,"w-full","h-full",3,"src"]],template:function(e,i){if(e&1&&(a(0,"div",0)(1,"div",1)(2,"h2",2),l(3," Nuestra "),a(4,"i",3),l(5,"cartelera"),o()()()(),a(6,"div",4)(7,"h2",5),l(8,"Filtros"),o(),a(9,"div",6)(10,"form",7),u("ngSubmit",function(){return i.onSubmit()}),a(11,"fieldset",8)(12,"div",9)(13,"div",10)(14,"legend",11),l(15," Fecha "),o()(),a(16,"select",12),E(17,Ue,3,5,"option",13,B),o()(),a(19,"div",14)(20,"button",15),l(21," Ver cartelera "),o()()()()()(),y(22,Ge,2,0,"div",16)(23,qe,2,0,"h2",17),a(24,"div",18)(25,"div",19),E(26,Ye,6,5,"div",20,Be),o()(),y(28,We,6,4,"div",21)),e&2){let n;s(10),h("formGroup",i.form),s(7),w((n=i.carteleraResource.value())==null?null:n.listaFechas),s(5),S(i.isLoading()?22:-1),s(),S(i.isEmpty()?23:-1),s(3),w(i.films()),s(2),S(i.isOpenModal()?28:-1)}},dependencies:[J,te,$e,Oe,ze,Ae,Ve,Le,Re,De,Ie,Ee],styles:['.mio[_ngcontent-%COMP%]:hover:after{filter:blur(25px) saturate(1.8)}.mio[_ngcontent-%COMP%]:hover{cursor:pointer}.mio[_ngcontent-%COMP%]{position:relative;background-size:cover;background-image:url(/img/peli-1.jpg);background-repeat:no-repeat}.mio[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;background:inherit;content:"";filter:blur(15px) saturate(1.5);width:100%;height:100%;z-index:-1;transition:filter .3s ease}.mio-2[_ngcontent-%COMP%]:hover:after{filter:blur(25px) saturate(1.8)}.mio-2[_ngcontent-%COMP%]:hover{cursor:pointer}.mio-2[_ngcontent-%COMP%]{position:relative;background-size:cover;background-image:url(/img/peli-2.jpg);background-repeat:no-repeat}.mio-2[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;background:inherit;content:"";filter:blur(10px) saturate(1.5);width:100%;height:100%;z-index:-1}.info[_ngcontent-%COMP%]{position:relative;background:#eae5e537;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(10px);border-radius:10px;color:#fff;border:1px solid rgba(255,255,255,.201);border-top:none;width:100%;margin:20px auto 0}.loader[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;position:relative;animation:_ngcontent-%COMP%_rotate 1s linear infinite}.loader[_ngcontent-%COMP%]:before, .loader[_ngcontent-%COMP%]:after{content:"";box-sizing:border-box;position:absolute;inset:0;border-radius:50%;border:5px solid #fff;animation:_ngcontent-%COMP%_prixClipFix 2s linear infinite}.loader[_ngcontent-%COMP%]:after{transform:rotate3d(90,90,0,180deg);border-color:#ff3d00}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_prixClipFix{0%{clip-path:polygon(50% 50%,0 0,0 0,0 0,0 0,0 0)}50%{clip-path:polygon(50% 50%,0 0,100% 0,100% 0,100% 0,100% 0)}75%,to{clip-path:polygon(50% 50%,0 0,100% 0,100% 100%,100% 100%,100% 100%)}}.grid-peliculas[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));column-gap:50px;row-gap:50px;place-items:center}.modal-1[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:fixed;z-index:999999;left:0;top:0;width:100%;height:100%;background-color:#00000080}.contenido-modal[_ngcontent-%COMP%]{position:relative;background-color:#fff;width:60%;-webkit-animation-name:_ngcontent-%COMP%_animarsuperior;-webkit-animation-duration:.5s;animation-name:_ngcontent-%COMP%_animarsuperior;animation-duration:.5s}@-webkit-keyframes _ngcontent-%COMP%_animatetop{0%{top:-300px;opacity:0}to{top:0;opacity:1}}@keyframes _ngcontent-%COMP%_animarsuperior{0%{top:-300px;opacity:0}to{top:0;opacity:1}}.close[_ngcontent-%COMP%]{position:absolute;top:-50px;left:98%;color:#fff;float:right;font-size:30px;font-weight:700}.close[_ngcontent-%COMP%]:hover, .close[_ngcontent-%COMP%]:focus{color:#000;text-decoration:none;cursor:pointer}']})};function Xe(r,t){if(r&1){let e=C();a(0,"div",1),d(1,"img",2),a(2,"span",3),l(3,"Foto de "),a(4,"span",4),l(5),o(),l(6," en "),a(7,"span",4),l(8),o()(),a(9,"div",5)(10,"button",6),u("click",function(){g(e);let n=p();return x(n.prevSlide())}),l(11,"\u276E"),o(),a(12,"button",6),u("click",function(){g(e);let n=p();return x(n.nextSlide())}),l(13,"\u276F"),o()()()}if(r&2){let e=t.$implicit,i=t.$index,n=p();ue("id",e.url),h("ngClass",i===n.currentSlide()?"opacity-100 z-10":"opacity-0 z-0"),s(),ue("src",e.url,K),s(4),b(e.autor),s(3),b(n.platform)}}var oe=class r{urlBase="/img/posters/poster-";platform="Unsplash";posters=v();currentSlide=m(0);intervalo;prevSlide(){let t=this.currentSlide()===0?this.posters().length-1:this.currentSlide()-1;this.currentSlide.set(t),this.resetInterval()}nextSlide(){let t=this.currentSlide()===this.posters().length-1?0:this.currentSlide()+1;this.currentSlide.set(t),this.resetInterval()}ngOnInit(){this.startInterval()}startInterval(){this.intervalo=setInterval(()=>{this.nextSlide()},6e3)}resetInterval(){clearInterval(this.intervalo),this.startInterval()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=_({type:r,selectors:[["app-posters"]],inputs:{posters:[1,"posters"]},decls:3,vars:0,consts:[[1,"carousel","rounded-2xl","relative","w-full","max-w-[1200px]","md:max-h-[440px]","md:h-[440px]","mt-10","aspect-[16/9]"],[1,"carousel-item","absolute","top-0","left-0","transition-opacity","duration-800","ease-in-out","w-full","h-full",3,"id","ngClass"],[1,"w-full","h-full","md:h-[440px]","md:w-full","md:object-cover",3,"src"],[1,"hidden","md:block","md:absolute","md:top-100","md:left-[20px]"],[1,"text-red-600","font-bold"],[1,"absolute","left-5","right-5","top-1/2","flex","-translate-y-1/2","transform","justify-between"],[1,"btn","btn-circle",3,"click"]],template:function(e,i){e&1&&(a(0,"div",0),E(1,Xe,14,5,"div",1,B),o()),e&2&&(s(),w(i.posters()))},dependencies:[J],styles:["[_nghost-%COMP%]{display:block}"]})};var W=class r{carteleraService=f(T);urlBase="./img/posters/poster-";platform="Unsplash";posters=[{url:`${this.urlBase}1.jpg`,autor:"Krists Luhaers"},{url:`${this.urlBase}2.jpg`,autor:"Corina Rainer"},{url:`${this.urlBase}3.jpg`,autor:"GR Stocks"},{url:`${this.urlBase}4.jpg`,autor:"Andrijana Bozic"}];query=m(void 0);carteleraResource=F({request:()=>({query:this.query()}),loader:({request:t})=>t?this.carteleraService.searchCartelera(t.query):this.carteleraService.searchCartelera()});searchByDay(t){this.query.set(t)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=_({type:r,selectors:[["app-cartelera-peliculas"]],decls:6,vars:5,consts:[[1,"h-20","w-full","md:w-xl","mx-auto","rounded-b-[20px]","relative","z-1","bg-[#d9d9d9]","flex","items-center","justify-center"],["src","./img/cine-logo.png","alt","",1,"w-[280px]","h-auto","mx-auto","absolute"],[1,"cine","w-[90%]","max-w-[1800px]","mx-auto"],[1,"text-white","text-center","sticky","pb-10"],[3,"posters"],[3,"dia","films","isLoading","errorMessage","isEmpty"]],template:function(e,i){if(e&1&&(a(0,"div",0),d(1,"img",1),o(),a(2,"div",2)(3,"section",3),d(4,"app-posters",4),a(5,"app-lista-peliculas",5),u("dia",function(c){return i.searchByDay(c)}),o()()()),e&2){let n;s(4),h("posters",i.posters),s(),h("films",i.carteleraResource.value())("isLoading",i.carteleraResource.isLoading())("errorMessage",i.carteleraResource.error())("isEmpty",((n=i.carteleraResource.value())==null?null:n.length)==0)}},dependencies:[ae,oe],styles:['.mio[_ngcontent-%COMP%]{position:relative;background-size:cover;background-image:url(/img/peli-1.jpg);background-repeat:no-repeat}.mio[_ngcontent-%COMP%]:after{position:absolute;top:0;left:0;background:inherit;content:"";filter:blur(15px) saturate(1.5);width:100%;height:100%;z-index:-1;transition:filter .3s ease}.cine[_ngcontent-%COMP%]{background-image:url(/img/cinematrix-2.avif);background-repeat:no-repeat;background-size:cover;background-position:center;background-attachment:fixed}.titulo-gradiente[_ngcontent-%COMP%]{background:linear-gradient(90deg,#8b1c1c,#b22222,#c33,#e05252,#f08080);-webkit-background-clip:text;-webkit-text-fill-color:transparent}']})};var ne=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=_({type:r,selectors:[["app-footer"]],decls:21,vars:0,consts:[[1,"footer","sm:footer-horizontal","text-neutral-content","p-10","bg-gray-800"],[1,"mx-auto"],["width","50","height","50","viewBox","0 0 24 24","xmlns","http://www.w3.org/2000/svg","fill-rule","evenodd","clip-rule","evenodd",1,"fill-current"],["d","M22.672 15.226l-2.432.811.841 2.515c.33 1.019-.209 2.127-1.23 2.456-1.15.325-2.148-.321-2.463-1.226l-.84-2.518-5.013 1.677.84 2.517c.391 1.203-.434 2.542-1.831 2.542-.88 0-1.601-.564-1.86-1.314l-.842-2.516-2.431.809c-1.135.328-2.145-.317-2.463-1.229-.329-1.018.211-2.127 1.231-2.456l2.432-.809-1.621-4.823-2.432.808c-1.355.384-2.558-.59-2.558-1.839 0-.817.509-1.582 1.327-1.846l2.433-.809-.842-2.515c-.33-1.02.211-2.129 1.232-2.458 1.02-.329 2.13.209 2.461 1.229l.842 2.515 5.011-1.677-.839-2.517c-.403-1.238.484-2.553 1.843-2.553.819 0 1.585.509 1.85 1.326l.841 2.517 2.431-.81c1.02-.33 2.131.211 2.461 1.229.332 1.018-.21 2.126-1.23 2.456l-2.433.809 1.622 4.823 2.433-.809c1.242-.401 2.557.484 2.557 1.838 0 .819-.51 1.583-1.328 1.847m-8.992-6.428l-5.01 1.675 1.619 4.828 5.011-1.674-1.62-4.829z"],[1,"footer-title"],[1,"grid","grid-flow-col","gap-4"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24",1,"fill-current"],["d","M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z"],["d","M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"],["d","M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"]],template:function(e,i){e&1&&(a(0,"footer",0)(1,"aside",1),j(),a(2,"svg",2),d(3,"path",3),o(),Z(),a(4,"p"),l(5," Cinematrix S.L "),d(6,"br"),l(7," Proyectando pel\xEDculas desde 1998 "),o()(),a(8,"nav")(9,"h6",4),l(10,"Social"),o(),a(11,"div",5)(12,"a"),j(),a(13,"svg",6),d(14,"path",7),o()(),Z(),a(15,"a"),j(),a(16,"svg",6),d(17,"path",8),o()(),Z(),a(18,"a"),j(),a(19,"svg",6),d(20,"path",9),o()()()()())},styles:["[_nghost-%COMP%]{display:block}"]})};var le=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=_({type:r,selectors:[["app-cartelera-layout"]],decls:5,vars:0,consts:[[1,"cine","min-h-screen","w-full","relative"],[1,"absolute","inset-0","bg-black/20","z-0"]],template:function(e,i){e&1&&(d(0,"app-cartelera-top-menu"),a(1,"main",0),d(2,"div",1)(3,"router-outlet"),o(),d(4,"app-footer"))},dependencies:[Fe,Me,ne],styles:[".cine[_ngcontent-%COMP%]{background-image:url(/img/cinematrix-2.avif);background-repeat:no-repeat;background-size:cover;background-position:center;background-attachment:fixed}"]})};function Ze(r,t){r&1&&(a(0,"div",6),d(1,"span",12),o())}function et(r,t){if(r&1){let e=C();a(0,"div",7)(1,"div",13)(2,"p",14),l(3),R(4,"titlecase"),o()(),a(5,"div",15)(6,"p",14),l(7),R(8,"currency"),o()(),a(9,"div",16)(10,"div",17)(11,"div",18),u("click",function(){let n=g(e).$implicit,c=p();return x(c.onHandleClickLess(c.tarifasLocal()[n].nombre))}),a(12,"button",19),l(13," - "),o()(),a(14,"div",20),l(15),o(),a(16,"div",18),u("click",function(){let n=g(e).$implicit,c=p();return x(c.onHandleClickAdd(c.tarifasLocal()[n].nombre))}),a(17,"button",21),l(18,"+"),o()()()()()}if(r&2){let e=t.$implicit,i=p();s(3),b(Q(4,3,i.tarifasLocal()[e].nombre)),s(4),H(" ",fe(8,5,i.getPriceConverted(i.tarifasLocal()[e].precio),"EUR","symbol","1.2-2")," "),s(8),H(" ",i.tarifasLocal()[e].cantidad," ")}}var se=class r{router=f(U);carteleraService=f(T);activatedRoute=f(re);totalPrice=m(0);tarifasInput=v();tarifasLocal=m({});isEmpty=v();isError=v();isLoading=v();seleccionTarifas=new z;amount=m(0);id=m(0);inicializarTarifasLocal=k(()=>{this.tarifasInput()&&this.tarifasLocal.set(structuredClone(this.tarifasInput()??{}))});tarifasArray=Te(()=>Object.keys(this.tarifasLocal()));onHandleClickLess(t){let e=q({},this.tarifasLocal()),i,n=q({},e[t]),c=this.totalPrice();n.cantidad>0&&(n.cantidad--,c-=n.precio),e[t]=n,this.tarifasLocal.set(e),this.totalPrice.set(c),console.log(this.totalPrice())}onHandleClickAdd(t){let e=q({},this.tarifasLocal()),i;console.log(this.tarifasLocal());let n=q({},e[t]),c=this.totalPrice();n.cantidad<9&&(n.cantidad++,c+=n.precio),e[t]=n,console.log(e),this.tarifasLocal.set(e),this.totalPrice.set(c),console.log(this.totalPrice())}onHandleClickNext(){this.seleccionTarifas.emit(this.tarifasLocal())}getPriceConverted(t){return t/100}volver(){this.router.navigate(["/"])}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=_({type:r,selectors:[["app-seleccion-entradas"]],inputs:{tarifasInput:[1,"tarifasInput"],isEmpty:[1,"isEmpty"],isError:[1,"isError"],isLoading:[1,"isLoading"]},outputs:{seleccionTarifas:"seleccionTarifas"},decls:20,vars:9,consts:[[1,"mt-[-50px]","mb-[40px]","ml-[90px]","md:ml-0"],[1,"cursor-pointer","underline","text-white","hover:text-[#e2cbe8]","transition","inline-block","text-[16px]","md:text-[18px]",3,"click"],[1,"w-[500px]","h-[400px]","flex","flex-col"],[1,"w-full","mx-auto"],[1,"text-gray-300","text-2xl","md:text-4xl","text-center","mb-4"],[1,"flex","items-center","flex-col","justify-center","text-white"],[1,"flex","flex-col","items-center","justify-center","my-20"],[1,"p-5","flex","gap-5","md:gap-15","items-center"],[1,"mt-5"],[1,"text-2xl"],[1,"px-4","mt-5"],[1,"px-4","flex","items-center","justify-center","gap-1","py-1","border-2","border-red-600","text-red-600","rounded-full","font-semibold","tracking-wide","hover:bg-red-600","hover:text-white","transition-colors","duration-500",3,"click","disabled","ngClass"],[1,"loader"],[1,"w-20","text-left"],[1,""],[1,"w-15"],[1,"rounded-2xl","overflow-hidden","border-gray-700","border-2","w-25"],[1,"flex","items-center","justify-center","gap-3"],[1,"w-full","text-center","bg-gray-700","hover:cursor-pointer",3,"click"],[1,"text-white","text-center","pointer-events-none"],["type","button",1,"text-white","rounded-2xl","mx-[2px]"],[1,"text-white","pointer-events-none"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"p",1),u("click",function(){return i.volver()}),l(2,"< Volver"),o()(),a(3,"div",2)(4,"div",3)(5,"h2",4),l(6," Seleccione sus entradas "),o()(),a(7,"div",5),y(8,Ze,2,0,"div",6),E(9,et,19,10,"div",7,B),a(11,"div",8)(12,"p",9),l(13," Total: "),a(14,"span"),l(15),R(16,"currency"),o()()(),a(17,"div",10)(18,"button",11),u("click",function(){return i.totalPrice()>0?i.onHandleClickNext():""}),l(19," Siguiente "),o()()()()),e&2&&(s(8),S(i.isLoading()?8:-1),s(),w(i.tarifasArray()),s(6),b(fe(16,4,i.getPriceConverted(i.totalPrice()),"EUR","symbol","1.2-2")),s(3),h("disabled",i.totalPrice()===0)("ngClass",i.totalPrice()===0?"opacity-50 cursor-not-allowed":"cursor-pointer"))},dependencies:[ie,J,ee],styles:['.loader[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;position:relative;animation:_ngcontent-%COMP%_rotate 1s linear infinite}.loader[_ngcontent-%COMP%]:before, .loader[_ngcontent-%COMP%]:after{content:"";box-sizing:border-box;position:absolute;inset:0;border-radius:50%;border:5px solid #fff;animation:_ngcontent-%COMP%_prixClipFix 2s linear infinite}.loader[_ngcontent-%COMP%]:after{transform:rotate3d(90,90,0,180deg);border-color:#ff3d00}@keyframes _ngcontent-%COMP%_rotate{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_prixClipFix{0%{clip-path:polygon(50% 50%,0 0,0 0,0 0,0 0,0 0)}50%{clip-path:polygon(50% 50%,0 0,100% 0,100% 0,100% 0,100% 0)}75%,to{clip-path:polygon(50% 50%,0 0,100% 0,100% 100%,100% 100%,100% 100%)}}']})};function tt(r,t){r&1&&(a(0,"p"),l(1,"Ha ocurrido alg\xFAn ::("),o())}function it(r,t){if(r&1){let e=C();a(0,"div",12),u("click",function(){let n=g(e).$implicit,c=p(2);return x(c.onSeatClick(n.nombre,n.estado))}),d(1,"img",13),o()}if(r&2){let e=t.$implicit,i=p(2);de(e.estado==="DISPONIBLE"||i.asientosSelected().includes(e.nombre)?"cursor-pointer":""),s(),h("src",i.asientosSelected().includes(e.nombre)?"seat_select.svg":e.estado==="OCUPADO"?"seat_sold.svg":e.estado==="DISPONIBLE"?"seat_free.svg":"",K)}}function rt(r,t){if(r&1&&(a(0,"div",6)(1,"div",10)(2,"p"),l(3),o()(),E(4,it,2,3,"div",11,Se),o()),r&2){let e=t.$implicit,i=p();s(3),b(e),s(),w(i.devuelveValues(e))}}var ce=class r{sala=v(void 0);salaCopy=m([]);errorMessage=v();cantidadEntradas=v(0);carteleraService=f(T);ngOnChanges(t){if(t.sala){console.log("CHANGEES");let e=Object.keys(this.sala()?.asientos??{});this.salaCopy.set(e),this.devuelveKeys();let i=this.carteleraService.loadFromLocalStorage().asientosSeleccionados;this.asientosSelected.set(i??[])}}estado=new z;asientosSeleccionadosOutput=new z;salaInput=k(()=>{});asientos=[];asientosSelected=m([]);devuelveKeys(){return this.salaCopy()}devuelveValues(t){let e=this.sala()?.asientos[t]??[],i=[];for(let n of e){let c=Object.keys(n)[0],P=n[c],I=this.carteleraService.loadFromLocalStorage();i.push({nombre:c,estado:I.asientosSeleccionados?.includes(c)?"DISPONIBLE":P,imagen:I.asientosSeleccionados?.includes(c)?"seat_select.svg":P==="DISPONIBLE"?"seat_free.svg":P==="NO_DISPONIBLE"?"":P==="OCUPADO"?"seat_sold.svg":""})}return i}onSeatClick(t,e){if(e==="OCUPADO"&&!this.asientosSelected().includes(t)||e==="")return;let i=this.asientosSelected().filter(n=>n===t);if(i.length>0){let n=this.asientosSelected().filter(c=>c!=t);this.asientosSelected.set(n)}else{if(i&&this.asientosSelected().length>=this.cantidadEntradas())return;let n=[...this.asientosSelected()];n.push(t),this.asientosSelected.set(n)}}volver(){this.estado.emit(0)}nextStep(){this.cantidadEntradas()==this.asientosSelected().length&&(console.log(this.asientosSelected()),this.asientosSeleccionadosOutput.emit(this.asientosSelected()))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=_({type:r,selectors:[["app-sala"]],inputs:{sala:[1,"sala"],errorMessage:[1,"errorMessage"],cantidadEntradas:[1,"cantidadEntradas"]},outputs:{estado:"estado",asientosSeleccionadosOutput:"asientosSeleccionadosOutput"},features:[ve],decls:17,vars:3,consts:[[1,"text-white","hover:text-[#e2cbe8]","transition","inline-block","cursor-pointer","text-[16px]","md:text-[18px]","ml-[30px]","md:ml-0","underline",3,"click"],[1,"flex","flex-col","gap-y-1","md:gap-y-2","items-center"],[1,"my-6","flex","flex-col","items-center","w-full"],[1,"w-full"],["src","screen.svg","alt","",1,"w-full"],[1,"text-gray-100","text-2xl"],[1,"flex","items-center","justify-center","gap-1","md:gap-2"],[1,"flex","gap-40"],[1,"px-4","mt-5"],[1,"px-4","flex","items-center","justify-center","gap-1","py-1","border-2","border-red-600","text-red-600","rounded-full","font-semibold","tracking-wide","hover:bg-red-600","hover:text-white","transition-colors","duration-500",3,"click"],[1,"w-[17px]","md:w-6"],[1,"w-[17px]","md:w-6",3,"class"],[1,"w-[17px]","md:w-6",3,"click"],["alt","",3,"src"]],template:function(e,i){e&1&&(a(0,"div")(1,"p",0),u("click",function(){return i.volver()}),l(2," < Volver "),o()(),y(3,tt,2,0,"p"),a(4,"div",1)(5,"div",2)(6,"div",3),d(7,"img",4),o(),a(8,"div")(9,"p",5),l(10,"Pantalla"),o()()(),E(11,rt,6,1,"div",6,B),a(13,"div",7)(14,"div",8)(15,"button",9),u("click",function(){return i.nextStep()}),l(16," Siguiente "),o()()()()),e&2&&(s(3),S(i.errorMessage()?3:-1),s(8),w(i.devuelveKeys()),s(4),de(i.asientosSelected().length===i.cantidadEntradas()?"cursor-pointer":"opacity-50 cursor-not-allowed"))},styles:["[_nghost-%COMP%]{display:block}"]})};var at=(r,t)=>t.nombre;function ot(r,t){r&1&&(a(0,"p",2),d(1,"i",3),l(2," Ha ocurrido alg\xFAn error en la reserva. Puede que ya est\xE9 ocupada :( "),o())}function nt(r,t){if(r&1&&(a(0,"p"),l(1),o(),a(2,"p"),l(3),R(4,"titlecase"),o()),r&2){let e=t.$implicit;s(),b(e.cantidad),s(2),b(Q(4,2,e.nombre))}}function lt(r,t){r&1&&(a(0,"h2",17),d(1,"i",18),l(2,"Ha ocurrido alg\xFAn error en la compra. Vuelva a intentarlo :( "),o(),d(3,"div"))}function st(r,t){r&1&&(a(0,"h2",17),l(1,"Compra realizada! Disfrute la experiencia"),d(2,"i",19),o())}function ct(r,t){if(r&1&&y(0,st,3,0,"h2",17),r&2){let e=p(3);S(e.value()?0:-1)}}function pt(r,t){if(r&1&&y(0,lt,4,0)(1,ct,1,1),r&2){let e=p(2);S(e.error()?0:1)}}function mt(r,t){if(r&1){let e=C();a(0,"div",4)(1,"div",5)(2,"h2",6),l(3," Detalle de "),a(4,"span",7),l(5,"compra"),o()()()(),a(6,"div",8)(7,"div",9)(8,"div",10)(9,"p",11),l(10,"Pelicula:"),o(),a(11,"p",12),l(12),o()(),a(13,"div",10)(14,"p",11),l(15,"Butacas:"),o(),a(16,"p",12),l(17),o()(),a(18,"div",10)(19,"p",11),l(20,"Sala:"),o(),a(21,"p",12),l(22),R(23,"titlecase"),o()(),a(24,"div",10)(25,"p",11),l(26,"Tarifas:"),o(),E(27,nt,5,4,null,null,at),o(),a(29,"div",10)(30,"p",13),l(31,"Total:"),o(),a(32,"p",14),l(33),R(34,"currency"),o()()(),a(35,"div",15)(36,"button",16),u("click",function(){g(e);let n=p();return x(n.comprar())}),l(37,"Comprar"),o()()(),y(38,pt,2,1)}if(r&2){let e,i,n,c,P,I=p();s(12),b((e=I.detalle())==null?null:e.pelicula),s(5),b((i=I.detalle())==null?null:i.butacas),s(5),b(Q(23,5,(n=I.detalle())==null?null:n.sala)),s(5),w((c=I.detalle())==null?null:c.tarifas),s(6),b(Y(34,7,(P=I.detalle())==null?null:P.total,"EUR")),s(5),S(I.finalizar()?38:-1)}}var pe=class r{carteleraService=f(T);finalizar=m(void 0);estado=new z;errorMessage=v();detalle=v();value=m(void 0);error=m(void 0);router=f(U);volver(){(this.value()||this.error())&&this.router.navigate(["cartelera"]),this.estado.emit(1)}finalizarCompraResource=F({request:()=>({finalizar:this.finalizar()}),loader:({request:t})=>t.finalizar?this.carteleraService.postFinalizarCompra():N(void 0)});comprar(){this.finalizar()||(this.finalizar.set(!0),this.finalizarCompraResource.reload())}comprobarResultado=k(()=>{let t=this.finalizarCompraResource.error(),e=this.finalizarCompraResource.value();console.log(e,t),t&&this.error.set(!0),e&&this.value.set(!0)});static \u0275fac=function(e){return new(e||r)};static \u0275cmp=_({type:r,selectors:[["app-compra-final"]],inputs:{errorMessage:[1,"errorMessage"],detalle:[1,"detalle"]},outputs:{estado:"estado"},decls:6,vars:2,consts:[[1,"w-[90%]","mx-auto","md:w-2xl","h-100"],[1,"text-white","underline","hover:text-[#e2cbe8]","transition","inline-block","cursor-pointer","text-[16px]","md:text-[18px]","ml-[30px]","md:ml-0",3,"click"],[1,"text-xl","text-white"],[1,"fa-solid","fa-circle-xmark","mr-3","mt-8",2,"color","#ea0606"],[1,"flex","w-full","flex-col","mt-15","max-w-[1200px]","mx-auto"],[1,"divider","divider-error","mb-10"],[1,"text-2xl","md:text-4xl"],[1,"text-red-500","font-semibold"],[1,"text-white","text-xl","flex","items-center","justify-center","flex-col"],[1,"flex","flex-col","items-start","gap-4"],[1,"flex","gap-2"],[1,"text-red-200"],[1,""],[1,"text-xl","text-red-200"],[1,"text-xl"],[1,"mt-10"],[1,"btn","btn-error","bg-red-600","text-white","border-red-600",3,"click"],[1,"md:text-2xl","text-white","text-center","mt-4"],[1,"fa-solid","fa-circle-xmark","mr-3",2,"color","#ea0606"],[1,"fa-solid","fa-circle-check","ml-3",2,"color","#63E6BE"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div")(2,"p",1),u("click",function(){return i.volver()}),l(3," < Volver "),o()(),y(4,ot,3,0,"p",2)(5,mt,39,10),o()),e&2&&(s(4),S(i.errorMessage()?4:-1),s(),S(i.detalle()?5:-1))},dependencies:[ee,ie],styles:["[_nghost-%COMP%]{display:block}"]})};function dt(r,t){if(r&1){let e=C();a(0,"div",0)(1,"app-seleccion-entradas",3),u("seleccionTarifas",function(n){g(e);let c=p();return x(c.sendTarifas(n))}),o()()}if(r&2){let e,i=p();s(),h("tarifasInput",i.tarifas())("isError",i.carteleraResource.error())("isEmpty",((e=i.carteleraResource.value())==null?null:e.length)===0)("isLoading",i.carteleraResource.isLoading())}}function ut(r,t){if(r&1){let e=C();a(0,"div",1)(1,"app-sala",4),u("estado",function(n){g(e);let c=p();return x(c.volverATarifas(n))})("asientosSeleccionadosOutput",function(n){g(e);let c=p();return x(c.enviarSeleccionFinal(n))}),o()()}if(r&2){let e=p();s(),h("sala",e.tarifasResource.value())("errorMessage",e.tarifasResource.error())("cantidadEntradas",e.cantidadEntradas())}}function ft(r,t){if(r&1){let e=C();a(0,"div",2)(1,"app-compra-final",5),u("estado",function(n){g(e);let c=p();return x(c.volverASala(n))}),o()()}if(r&2){let e=p();s(),h("errorMessage",e.ocupacionResource.error())("detalle",e.getDetalleResource.value())}}var me=class r{router=f(U);carteleraService=f(T);activatedRoute=f(re);sala=m(void 0);cancelarCompra=m(void 0);cantidadEntradas=m(0);tarifas=m({});existeCompra=m(!1);tarifasSelected=m(void 0);asientosSelected=m(void 0);id=m(void 0);estadoProceso=m(0);carteleraResource=F({loader:({request:t})=>this.carteleraService.getTarifas()});ngOnInit(){this.activatedRoute.paramMap.subscribe(e=>{this.id.set(Number(e.get("id")))});let t=this.carteleraService.loadFromLocalStorage();if(t.estado){if(t.estado==1){if(t.tarifas&&t.idCompra){this.asientosSelected.set(structuredClone(t.asientosSeleccionados)),console.log(this.asientosSelected()),this.tarifasSelected.set(t.tarifas),console.log(t.asientosSeleccionados);let e=0;for(let i of this.tarifasSelected()??[])e+=i.cantidad;this.cantidadEntradas.set(e),this.estadoProceso.set(1),this.existeCompra.set(!0),this.ocupacionResource.reload()}}else if(t.estado==2&&t.asientosSeleccionados&&t.idCompra&&t.tarifas){this.asientosSelected.set(structuredClone(t.asientosSeleccionados)),console.log(this.asientosSelected()),this.existeCompra.set(!0),this.estadoProceso.set(2),this.tarifasSelected.set(t.tarifas);let e=0;for(let i of this.tarifasSelected()??[])e+=i.cantidad;this.cantidadEntradas.set(e)}}}tarifasResource=F({request:()=>({tarifa:this.tarifasSelected(),id:this.id(),existeCompra:this.existeCompra()}),loader:({request:t})=>(console.log(t.tarifa,t.id),console.log("Holaa"),!t.tarifa||!t.id?(this.estadoProceso.set(0),N(void 0)):this.estadoProceso()===0||this.estadoProceso()===1?this.carteleraService.postSelectedTarifas(t.tarifa,t.id,this.existeCompra()).pipe($(e=>structuredClone(e))):N(void 0))});yaTieneValor=m(!1);resultadoTarifas=k(()=>{let t=this.tarifasResource.value();console.log(t),t&&this.estadoProceso.set(1)});constructor(){this.router.events.pipe(xe(t=>t instanceof ke)).subscribe(t=>{if(!t.url.includes("cartelera/sesion")){let i=this.carteleraService.loadFromLocalStorage();this.estadoProceso()!==3&&i&&navigator.sendBeacon(`/api/cartelera/compra/cancelar/${i.idCompra}`),localStorage.removeItem("seleccion")}}),window.addEventListener("beforeunload",()=>{let t=this.carteleraService.loadFromLocalStorage(),e=performance.getEntriesByType("navigation")[0];t.idCompra&&e?.type!=="reload"&&(this.estadoProceso()!==3&&navigator.sendBeacon(`/api/cartelera/compra/cancelar/${t.idCompra}`),localStorage.removeItem("seleccion"))})}transformarAObjeto=k(()=>{if(this.carteleraResource.hasValue()){let t=this.carteleraResource.value(),e={};for(let i of t)e[i.nombre]={nombre:i.nombre,precio:i.precio*100,cantidad:0};console.log(this.carteleraService.getTotalTarifas()),this.tarifas.set(e)}});sendTarifas(t){console.log(t);let e=D.mapTarifasSeleccionadasToRESTTarifasSeleccionadas(t);console.log(e),this.tarifasSelected.set(structuredClone(e)),this.existeCompra.set(!1);let i=0;for(let n of this.tarifasSelected()??[])i+=n.cantidad;console.log(i),this.cantidadEntradas.set(i),this.tarifasResource.reload()}volverATarifas(t){let e=this.carteleraService.loadFromLocalStorage();e&&(e.estado=0),this.carteleraService.saveToLocalStorage(e),this.cancelarCompra.set(!0),this.cancelarResource.reload(),this.estadoProceso.set(0)}ocupacionResource=F({request:()=>({asientos:this.asientosSelected()}),loader:({request:t})=>t.asientos?this.carteleraService.postFinalSelection(t.asientos):N(void 0)});cancelarResource=F({request:()=>({cancelar:this.cancelarCompra()}),loader:({request:t})=>t.cancelar?this.carteleraService.cancelarCompra():N()});getDetalle=m(void 0);getDetalleResource=F({request:()=>({getDetalle:this.getDetalle()}),loader:({request:t})=>t.getDetalle?this.carteleraService.getDetalleCompra():N()});detalle=m(void 0);getDetalleEffect=k(()=>{this.ocupacionResource.hasValue()&&this.getDetalle.set(!0)});enviarSeleccionFinal(t){console.log(t),this.estadoProceso.set(2),this.asientosSelected.set(t),this.ocupacionResource.reload(),setTimeout(()=>{this.getDetalleResource.reload()},100)}volverASala(t){let e=this.carteleraService.loadFromLocalStorage();e&&(e.estado=1),this.carteleraService.saveToLocalStorage(e),console.log(t),this.estadoProceso.set(t),this.existeCompra.set(!0),this.tarifasResource.reload()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=_({type:r,selectors:[["app-cartelera-sesion-page"]],decls:3,vars:1,consts:[[1,"h-screen","info","flex","items-center","justify-center","pb-[40px]"],[1,"h-screen","info","flex","items-center","justify-center","pb-[100px]"],[1,"h-screen","info","flex","items-center","justify-center","pb-[300px]"],[3,"seleccionTarifas","tarifasInput","isError","isEmpty","isLoading"],[3,"estado","asientosSeleccionadosOutput","sala","errorMessage","cantidadEntradas"],[3,"estado","errorMessage","detalle"]],template:function(e,i){e&1&&y(0,dt,2,4,"div",0)(1,ut,2,3,"div",1)(2,ft,2,2,"div",2),e&2&&S(i.estadoProceso()==0?0:i.estadoProceso()==1?1:i.estadoProceso()==2?2:-1)},dependencies:[se,ce,pe],styles:["[_nghost-%COMP%]{display:block}.info[_ngcontent-%COMP%]{position:relative;background:#eae5e50d;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(10px);border-radius:10px;color:#fff;border:1px solid rgba(255,255,255,.201);border-top:none;width:100%}"]})};var gt=[{path:"",component:le,children:[{path:"peliculas",component:W},{path:"",component:W},{path:"sesion/:id",component:me},{path:"**",redirectTo:"peliculas"}]}],Qi=gt;export{gt as countryRoutes,Qi as default};
